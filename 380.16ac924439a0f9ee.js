"use strict";(self.webpackChunkmy_finance_front=self.webpackChunkmy_finance_front||[]).push([[380],{9380:(qt,I,p)=>{p.r(I),p.d(I,{ExtratoBancarioModule:()=>Ut});var F=p(9032),g=p(467),h=p(2572),t=p(540),v=p(121);let M=(()=>{class n{constructor(a){this.api=a}listExtratos(a,e){return this.api.get("/GetExtratoBancarioItensByMonth?month="+a)}createExtratoManualItem(a){return this.api.post("/CreateExtratoBancarioItem",a)}updateExtratoItem(a){return this.api.put("/UpdateExtratoBancarioItem",{...a})}importExtrato(a,e){const o=new FormData;return o.append("arquivo",a),o.append("bancoId",String(e.id)),o.append("nomeBanco",e.nomeBanco??""),null!=e.tipoCartaoId&&o.append("tipoCartaoId",String(e.tipoCartaoId)),this.api.post("/ImportExtratoBancario",o)}static{this.\u0275fac=function(e){return new(e||n)(t.KVO(v.G))}}static{this.\u0275prov=t.jDH({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();var R=p(3336),y=p(7794),k=p(5403),E=p(7008),T=p(1259),b=p(177),l=p(4341);let j=(()=>{class n{constructor(a,e){this.el=a,this.ngControl=e,this.appMoneyMaskBRAsNumber=!1}onInput(){const a=this.el.nativeElement,e=(0,h.g9)(a.value);a.value=e,this.ngControl?.control&&this.ngControl.control.setValue(this.appMoneyMaskBRAsNumber?(0,h.Yj)(e):e,{emitEvent:!1});const o=e.length;a.setSelectionRange(o,o)}onBlur(){this.onInput()}static{this.\u0275fac=function(e){return new(e||n)(t.rXU(t.aKT),t.rXU(l.vO,8))}}static{this.\u0275dir=t.FsC({type:n,selectors:[["","appMoneyMaskBR",""]],hostBindings:function(e,o){1&e&&t.bIt("input",function(s){return o.onInput(s)})("blur",function(){return o.onBlur()})},inputs:{appMoneyMaskBRAsNumber:"appMoneyMaskBRAsNumber"}})}}return n})(),B=(()=>{class n{constructor(a){this.api=a}listExtratos(a,e){return this.api.get("/GetExtratoBancario?month="+a)}createExtratoManualItem(a){return this.api.post("/CreateExtratoBancarioItem",a)}updateExtratoItem(a){return this.api.put("/UpdateExtratoBancarioItem",{...a})}deleteExtrato(a){return this.api.delete("/DeleteExtratoBancario",a)}static{this.\u0275fac=function(e){return new(e||n)(t.KVO(v.G))}}static{this.\u0275prov=t.jDH({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();function G(n,i){1&n&&(t.j41(0,"div",13),t.nrm(1,"span",14),t.EFF(2," Carregando... "),t.k0s())}function N(n,i){if(1&n&&(t.j41(0,"div",15),t.EFF(1),t.k0s()),2&n){const a=t.XpG();t.R7$(1),t.SpI(" ",a.errorMsg," ")}}function $(n,i){1&n&&(t.j41(0,"tr")(1,"td",23),t.EFF(2,"Nenhuma importa\xe7\xe3o realizada."),t.k0s()())}function D(n,i){if(1&n){const a=t.RV6();t.j41(0,"tr")(1,"td"),t.EFF(2),t.k0s(),t.j41(3,"td"),t.EFF(4),t.k0s(),t.j41(5,"td"),t.EFF(6),t.k0s(),t.j41(7,"td"),t.EFF(8),t.k0s(),t.j41(9,"td",24)(10,"div",25)(11,"button",26),t.bIt("click",function(){const r=t.eBV(a).$implicit,s=t.XpG(2);return t.Njj(s.removeRow(r))}),t.EFF(12," Excluir "),t.k0s()()()()}if(2&n){const a=i.$implicit,e=t.XpG(2);t.R7$(2),t.JRh(a.dataImportacao),t.R7$(2),t.JRh(a.bancoNome),t.R7$(2),t.JRh(a.nomeArquivoOrigem),t.R7$(2),t.JRh(a.quantidadeLancamentos),t.R7$(3),t.Y8G("disabled",e.savingIds.has(a.id))}}function S(n,i){if(1&n&&(t.j41(0,"div",16)(1,"table",17)(2,"thead",18)(3,"tr")(4,"th",19),t.EFF(5,"Data importa\xe7\xe3o"),t.k0s(),t.j41(6,"th",19),t.EFF(7,"Banco importa\xe7\xe3o"),t.k0s(),t.j41(8,"th",19),t.EFF(9,"Nome arquivo"),t.k0s(),t.j41(10,"th",19),t.EFF(11,"Quantidade de lan\xe7amentos"),t.k0s(),t.j41(12,"th",20),t.EFF(13,"A\xe7\xf5es"),t.k0s()()(),t.j41(14,"tbody"),t.DNE(15,$,3,0,"tr",21),t.DNE(16,D,13,5,"tr",22),t.k0s()()()),2&n){const a=t.XpG();t.R7$(15),t.Y8G("ngIf",0===a.importacaoesMensais.length),t.R7$(1),t.Y8G("ngForOf",a.importacaoesMensais)("ngForTrackBy",a.trackById)}}let w=(()=>{class n{constructor(a){this.extratobancarioService=a,this.mesExtrato="",this.closed=new t.bkB,this.loading=!1,this.errorMsg="",this.savingIds=new Set,this.importacaoesMensais=[],this.trackById=(e,o)=>o.id}ngOnInit(){var a=this;return(0,g.A)(function*(){yield a.loadAll()})()}loadAll(){var a=this;return(0,g.A)(function*(){a.loading=!0,a.errorMsg="";try{a.importacaoesMensais=yield a.extratobancarioService.listExtratos(a.mesExtrato)}catch(e){a.errorMsg=e?.error?.message||e?.message||"Erro ao carregar dados."}finally{a.loading=!1}})()}close(a=!1){this.closed.emit({reload:a})}removeRow(a){var e=this;return(0,g.A)(function*(){if(e.errorMsg="",a.id<0)e.importacaoesMensais=e.importacaoesMensais.filter(o=>o.id!==a.id);else if(confirm(`Excluir "${a.nomeArquivoOrigem}"?`)){e.savingIds.add(a.id);try{yield e.extratobancarioService.deleteExtrato(a.id),e.importacaoesMensais=e.importacaoesMensais.filter(o=>o.id!==a.id)}catch(o){e.errorMsg=o?.error?.message||o?.message||"Erro ao excluir."}finally{e.savingIds.delete(a.id)}}})()}static{this.\u0275fac=function(e){return new(e||n)(t.rXU(B))}}static{this.\u0275cmp=t.VBU({type:n,selectors:[["app-modal-importacoes-mensais"]],inputs:{mesExtrato:"mesExtrato"},outputs:{closed:"closed"},decls:26,vars:3,consts:[[1,"modal-backdrop-custom",3,"click"],["role","dialog","aria-modal","true",1,"modal-custom"],[1,"modal-card","card"],[1,"card-header","d-flex","align-items-center","justify-content-between"],[1,"card-title","m-0"],[1,"card-body","modal-body-scroll"],["class","text-primary",4,"ngIf"],["class","alert alert-danger py-2",4,"ngIf"],["class","table-responsive",4,"ngIf"],[1,"form-text","mt-2"],[1,"card-footer","d-flex","justify-content-end","gap-2"],[1,"btn","btn-outline-secondary",3,"click"],[1,"btn","btn-primary",3,"click"],[1,"text-primary"],[1,"spinner-border","spinner-border-sm","me-2"],[1,"alert","alert-danger","py-2"],[1,"table-responsive"],[1,"table","table-hover","align-middle","mb-0"],[1,"bg-body-tertiary"],[2,"min-width","220px"],[1,"text-end",2,"width","160px"],[4,"ngIf"],[4,"ngFor","ngForOf","ngForTrackBy"],["colspan","5",1,"text-center","text-muted","py-4"],[1,"text-end"],[1,"d-inline-flex","gap-2"],[1,"btn","btn-sm","btn-outline-danger",3,"disabled","click"]],template:function(e,o){1&e&&(t.j41(0,"div",0),t.bIt("click",function(){return o.close(!1)}),t.k0s(),t.j41(1,"div",1)(2,"div",2)(3,"div",3)(4,"h3",4),t.EFF(5,"Importa\xe7\xf5es realizadas"),t.k0s()(),t.j41(6,"div",5),t.DNE(7,G,3,0,"div",6),t.DNE(8,N,2,1,"div",7),t.DNE(9,S,17,3,"div",8),t.j41(10,"div",9),t.EFF(11," Dica: preencha "),t.j41(12,"strong"),t.EFF(13,"Nome"),t.k0s(),t.EFF(14," e opcionalmente vincule "),t.j41(15,"strong"),t.EFF(16,"Categoria"),t.k0s(),t.EFF(17," e "),t.j41(18,"strong"),t.EFF(19,"Tipo"),t.k0s(),t.EFF(20,". "),t.k0s()(),t.j41(21,"div",10)(22,"button",11),t.bIt("click",function(){return o.close(!1)}),t.EFF(23,"Fechar"),t.k0s(),t.j41(24,"button",12),t.bIt("click",function(){return o.close(!0)}),t.EFF(25,"Concluir"),t.k0s()()()()),2&e&&(t.R7$(7),t.Y8G("ngIf",o.loading),t.R7$(1),t.Y8G("ngIf",o.errorMsg),t.R7$(1),t.Y8G("ngIf",!o.loading))},dependencies:[b.Sq,b.bT]})}}return n})();function V(n,i){if(1&n&&(t.j41(0,"div",35),t.EFF(1),t.k0s()),2&n){const a=t.XpG();t.AVh("alert-success","success"===a.alert.type)("alert-danger","error"===a.alert.type)("alert-warning","warning"===a.alert.type),t.R7$(1),t.SpI(" ",a.alert.message," ")}}function P(n,i){if(1&n&&(t.j41(0,"option",36),t.EFF(1),t.k0s()),2&n){const a=i.$implicit;t.Y8G("value",a.id),t.R7$(1),t.JRh(a.nomeBanco)}}function Y(n,i){if(1&n&&(t.j41(0,"option",36),t.EFF(1),t.k0s()),2&n){const a=i.$implicit;t.Y8G("value",a.id),t.R7$(1),t.SpI(" ",a.nomeTipoCartao||"Tipo #"+a.id," ")}}function A(n,i){1&n&&(t.j41(0,"tr")(1,"td",37),t.EFF(2,"Carregando..."),t.k0s()())}function X(n,i){1&n&&(t.j41(0,"tr")(1,"td",37),t.EFF(2," Nenhuma transa\xe7\xe3o encontrada com os filtros aplicados. "),t.k0s()())}function L(n,i){if(1&n){const a=t.RV6();t.j41(0,"tr")(1,"td"),t.EFF(2),t.k0s(),t.j41(3,"td"),t.EFF(4),t.k0s(),t.j41(5,"td",38),t.EFF(6),t.k0s(),t.j41(7,"td",39),t.EFF(8),t.k0s(),t.j41(9,"td",31)(10,"div",40)(11,"button",41),t.bIt("click",function(){t.eBV(a);const o=t.XpG().$implicit,r=t.XpG();return t.Njj(r.goToDetalhe(o))}),t.EFF(12," \u270f\ufe0f "),t.k0s()()()()}if(2&n){const a=t.XpG().$implicit,e=t.XpG();t.R7$(2),t.JRh(a.bancoNome),t.R7$(2),t.JRh(a.tipoContaNome),t.R7$(2),t.JRh(e.money(a.totalEntrada)),t.R7$(2),t.JRh(e.money(a.totalSaida))}}function O(n,i){if(1&n&&(t.qex(0),t.DNE(1,L,13,4,"tr",32),t.bVm()),2&n){const a=t.XpG();t.R7$(1),t.Y8G("ngIf",!a.loading&&a.resumo.length>0)}}function U(n,i){if(1&n&&(t.j41(0,"option",36),t.EFF(1),t.k0s()),2&n){const a=i.$implicit;t.Y8G("value",a.id),t.R7$(1),t.JRh(a.nomeBanco)}}function J(n,i){if(1&n&&(t.j41(0,"option",36),t.EFF(1),t.k0s()),2&n){const a=i.$implicit;t.Y8G("value",a.id),t.R7$(1),t.SpI("",a.nomeTipoCartao||"Tipo #"+a.id," ")}}function q(n,i){if(1&n){const a=t.RV6();t.qex(0),t.j41(1,"div",42)(2,"div",43)(3,"div",44)(4,"div",45)(5,"h5",46),t.EFF(6,"Importar extrato"),t.k0s(),t.j41(7,"button",47),t.bIt("click",function(){t.eBV(a);const o=t.XpG();return t.Njj(o.closeImportModal())}),t.EFF(8," \u2715 "),t.k0s()(),t.j41(9,"div",48)(10,"div",49)(11,"label",50),t.EFF(12,"Banco"),t.k0s(),t.j41(13,"select",51),t.bIt("change",function(o){t.eBV(a);const r=t.XpG();return t.Njj(r.onBancoModalChange(o.target.value))}),t.j41(14,"option",22),t.EFF(15,"Selecione..."),t.k0s(),t.DNE(16,U,2,2,"option",23),t.k0s()(),t.j41(17,"div",49)(18,"label",50),t.EFF(19,"Tipo Conta (autom\xe1tico)"),t.k0s(),t.j41(20,"select",52)(21,"option",22),t.EFF(22),t.k0s(),t.DNE(23,J,2,2,"option",23),t.k0s(),t.j41(24,"small",53),t.EFF(25,"O tipo de conta \xe9 definido pelo banco selecionado."),t.k0s()(),t.j41(26,"div",54)(27,"label",50),t.EFF(28,"Arquivo"),t.k0s(),t.j41(29,"input",55),t.bIt("change",function(o){t.eBV(a);const r=t.XpG();return t.Njj(r.onFileSelected(o))}),t.k0s()()(),t.j41(30,"div",56)(31,"button",57),t.bIt("click",function(){t.eBV(a);const o=t.XpG();return t.Njj(o.closeImportModal())}),t.EFF(32,"Cancelar"),t.k0s(),t.j41(33,"button",57),t.bIt("click",function(o){t.eBV(a);const r=t.XpG();return t.Njj(r.onSave(o))}),t.EFF(34,"Salvar"),t.k0s()()()()(),t.nrm(35,"div",58),t.bVm()}if(2&n){const a=t.XpG();t.R7$(7),t.Y8G("disabled",a.importLoading),t.R7$(6),t.Y8G("value",a.selectedBancoId)("disabled",a.importLoading),t.R7$(3),t.Y8G("ngForOf",a.bancos),t.R7$(4),t.Y8G("value",a.selectedTipoContaId),t.R7$(2),t.JRh(a.selectedTipoContaId?"Carregado":"\u2014"),t.R7$(1),t.Y8G("ngForOf",a.tiposConta),t.R7$(6),t.Y8G("disabled",a.importLoading),t.R7$(2),t.Y8G("disabled",a.importLoading),t.R7$(2),t.Y8G("disabled",a.importLoading)}}function K(n,i){if(1&n&&(t.j41(0,"option",36),t.EFF(1),t.k0s()),2&n){const a=i.$implicit;t.Y8G("value",a.id),t.R7$(1),t.JRh(a.nomeBanco)}}function z(n,i){if(1&n&&(t.j41(0,"option",36),t.EFF(1),t.k0s()),2&n){const a=i.$implicit;t.Y8G("value",a.id),t.R7$(1),t.SpI(" ",a.name," ")}}function H(n,i){if(1&n){const a=t.RV6();t.qex(0),t.j41(1,"div",62)(2,"label",50),t.EFF(3,"Total de parcelas"),t.k0s(),t.j41(4,"input",78),t.bIt("input",function(o){t.eBV(a);const r=t.XpG(3);return t.Njj(r.setManual("totalParcelas",o.target.value))}),t.k0s()(),t.j41(5,"div",62)(6,"label",50),t.EFF(7,"Parcela atual"),t.k0s(),t.j41(8,"input",79),t.bIt("input",function(o){t.eBV(a);const r=t.XpG(3);return t.Njj(r.setManual("numeroParcela",o.target.value))}),t.k0s()(),t.j41(9,"div",62)(10,"label",50),t.EFF(11,"Grupo parcelamento (opcional)"),t.k0s(),t.j41(12,"input",71),t.bIt("input",function(o){t.eBV(a);const r=t.XpG(3);return t.Njj(r.setManual("grupoParcelamentoId",o.target.value))}),t.k0s()(),t.bVm()}if(2&n){const a=t.XpG(3);t.R7$(4),t.Y8G("value",a.manualForm.totalParcelas),t.R7$(4),t.Y8G("value",a.manualForm.numeroParcela),t.R7$(4),t.Y8G("value",a.manualForm.grupoParcelamentoId)}}function Q(n,i){if(1&n){const a=t.RV6();t.qex(0),t.j41(1,"div",72)(2,"div",75)(3,"input",76),t.bIt("change",function(o){t.eBV(a);const r=t.XpG(2);return t.Njj(r.setManual("parcelado",o.target.checked))}),t.k0s(),t.j41(4,"label",77),t.EFF(5,"Compra parcelada"),t.k0s()()(),t.DNE(6,H,13,3,"ng-container",32),t.bVm()}if(2&n){const a=t.XpG(2);t.R7$(3),t.Y8G("checked",a.manualForm.parcelado),t.R7$(3),t.Y8G("ngIf",a.manualForm.parcelado)}}function Z(n,i){if(1&n){const a=t.RV6();t.qex(0),t.j41(1,"div",42)(2,"div",59)(3,"div",44)(4,"div",60)(5,"h5",46),t.EFF(6,"Adicionar item manual"),t.k0s(),t.j41(7,"button",47),t.bIt("click",function(){t.eBV(a);const o=t.XpG();return t.Njj(o.closeManualModal())}),t.EFF(8,"\u2715"),t.k0s()(),t.j41(9,"div",48)(10,"div",61)(11,"div",62)(12,"label",50),t.EFF(13,"Data"),t.k0s(),t.j41(14,"input",63),t.bIt("input",function(o){t.eBV(a);const r=t.XpG();return t.Njj(r.setManual("dataMovimentacao",o.target.value))}),t.k0s()(),t.j41(15,"div",62)(16,"label",50),t.EFF(17,"Tipo"),t.k0s(),t.j41(18,"select",64),t.bIt("change",function(o){t.eBV(a);const r=t.XpG();return t.Njj(r.setManual("tipo",o.target.value))}),t.j41(19,"option",65),t.EFF(20,"Entrada"),t.k0s(),t.j41(21,"option",66),t.EFF(22,"Sa\xedda"),t.k0s()()(),t.j41(23,"div",62)(24,"label",50),t.EFF(25,"Valor"),t.k0s(),t.j41(26,"input",67),t.bIt("input",function(o){t.eBV(a);const r=t.XpG();return t.Njj(r.setManual("valor",o.target.value))}),t.k0s()(),t.j41(27,"div",68)(28,"label",50),t.EFF(29,"Banco"),t.k0s(),t.j41(30,"select",64),t.bIt("change",function(o){t.eBV(a);const r=t.XpG();return t.Njj(r.setManual("bancoId",o.target.value))}),t.j41(31,"option",22),t.EFF(32,"Selecione..."),t.k0s(),t.DNE(33,K,2,2,"option",23),t.k0s()(),t.j41(34,"div",68)(35,"label",50),t.EFF(36,"Tipo Conta / Cart\xe3o"),t.k0s(),t.j41(37,"select",69)(38,"option",70),t.EFF(39),t.k0s()(),t.j41(40,"small",53),t.EFF(41,"O tipo conta/cart\xe3o \xe9 definido pelo banco selecionado."),t.k0s()(),t.j41(42,"div",68)(43,"label",50),t.EFF(44,"Categoria (opcional)"),t.k0s(),t.j41(45,"select",64),t.bIt("change",function(o){t.eBV(a);const r=t.XpG();return t.Njj(r.setManual("categoriaId",o.target.value))}),t.j41(46,"option",22),t.EFF(47,"Selecione..."),t.k0s(),t.DNE(48,z,2,2,"option",23),t.k0s()(),t.j41(49,"div",68)(50,"label",19),t.EFF(51,"Pessoa/ Estabelecimento"),t.k0s(),t.j41(52,"input",71),t.bIt("input",function(o){t.eBV(a);const r=t.XpG();return t.Njj(r.setManual("pessoaTransacao",o.target.value))}),t.k0s()(),t.j41(53,"div",68)(54,"label",50),t.EFF(55,"Descri\xe7\xe3o (opcional)"),t.k0s(),t.j41(56,"input",71),t.bIt("input",function(o){t.eBV(a);const r=t.XpG();return t.Njj(r.setManual("descricao",o.target.value))}),t.k0s()(),t.j41(57,"div",72)(58,"label",50),t.EFF(59,"Observa\xe7\xe3o (opcional)"),t.k0s(),t.j41(60,"textarea",73),t.bIt("input",function(o){t.eBV(a);const r=t.XpG();return t.Njj(r.setManual("observacao",o.target.value))}),t.k0s()(),t.DNE(61,Q,7,2,"ng-container",32),t.k0s()(),t.j41(62,"div",56)(63,"button",57),t.bIt("click",function(){t.eBV(a);const o=t.XpG();return t.Njj(o.closeManualModal())}),t.EFF(64,"Cancelar"),t.k0s(),t.j41(65,"button",74),t.bIt("click",function(){t.eBV(a);const o=t.XpG();return t.Njj(o.saveManualItem())}),t.EFF(66),t.k0s()()()()(),t.nrm(67,"div",58),t.bVm()}if(2&n){const a=t.XpG();t.R7$(7),t.Y8G("disabled",a.savingManual),t.R7$(7),t.Y8G("value",a.manualForm.dataMovimentacao),t.R7$(4),t.Y8G("value",a.manualForm.tipo),t.R7$(8),t.Y8G("value",a.manualForm.valor),t.R7$(4),t.Y8G("value",a.manualForm.bancoId),t.R7$(3),t.Y8G("ngForOf",a.bancos),t.R7$(4),t.Y8G("ngModel",a.manualForm.tipoCartaoId),t.R7$(1),t.Y8G("ngValue",a.manualForm.tipoCartaoId),t.R7$(1),t.SpI(" ",a.manualForm.tipoCartaoNome||"\u2014"," "),t.R7$(6),t.Y8G("value",a.manualForm.categoriaId),t.R7$(3),t.Y8G("ngForOf",a.categorias),t.R7$(4),t.Y8G("value",a.manualForm.pessoaTransacao),t.R7$(4),t.Y8G("value",a.manualForm.descricao),t.R7$(4),t.Y8G("value",a.manualForm.observacao),t.R7$(1),t.Y8G("ngIf",a.isCreditoSelecionado),t.R7$(2),t.Y8G("disabled",a.savingManual),t.R7$(2),t.Y8G("disabled",a.savingManual),t.R7$(1),t.SpI(" ",a.savingManual?"Salvando...":"Salvar"," ")}}function W(n,i){if(1&n){const a=t.RV6();t.j41(0,"app-modal-importacoes-mensais",80),t.bIt("closed",function(o){t.eBV(a);const r=t.XpG();return t.Njj(r.fecharImportacoesMensais(o))}),t.k0s()}if(2&n){const a=t.XpG();t.Y8G("mesExtrato",a.monthFilter)}}let et=(()=>{class n{constructor(a,e,o,r,s,d,c){this.router=a,this.extratoItemService=e,this.contaService=o,this.contaMensalService=r,this.tipoCartaoService=s,this.categoryService=d,this.bancoService=c,this.monthFilter=function tt(){const n=new Date,i=String(n.getMonth()+1).padStart(2,"0");return`${n.getFullYear()}-${i}`}(),this.bancoFilter="",this.tipoContaFilter="",this.alert={type:"",message:""},this.loading=!1,this.extratos=[],this.bancos=[],this.tiposConta=[],this.categorias=[],this.showImportModal=!1,this.importLoading=!1,this.selectedBancoId="",this.selectedBancoNome="",this.selectedTipoContaId="",this.showManualModal=!1,this.savingManual=!1,this.showToolbar=!1,this.showModalImportacoesMensais=!1,this.manualForm={dataMovimentacao:(0,h.vh)(),tipo:"SAIDA",valor:"",bancoId:"",tipoCartaoId:"",tipoCartaoNome:"",pessoaTransacao:"",categoriaId:"",descricao:"",observacao:"",parcelado:!1,totalParcelas:"",numeroParcela:"1",grupoParcelamentoId:""}}ngOnInit(){const a=new Date,e=String(a.getMonth()+1).padStart(2,"0");this.monthFilter=`${a.getFullYear()}-${e}`,this.refresh(),this.carregaFiltros()}carregaFiltros(){var a=this;return(0,g.A)(function*(){try{const[e,o,r]=yield Promise.all([a.bancoService.list(),a.tipoCartaoService.list(),a.categoryService.list()]);a.bancos=e??[],a.tiposConta=o??[],a.categorias=r??[]}catch{a.setAlert("warning","Falha ao carregar cat\xe1logos (bancos/tipos/categorias).")}})()}refresh(){var a=this;return(0,g.A)(function*(){a.loading=!0;try{const e=a.bancoFilter?Number(a.bancoFilter):null,o=yield a.extratoItemService.listExtratos(a.monthFilter,e);a.extratos=Array.isArray(o)?o:[]}catch{a.setAlert("error","Erro ao carregar extrato.")}finally{a.loading=!1}})()}fecharImportacoesMensais(a){this.showModalImportacoesMensais=!1,a?.reload&&this.refresh()}get resumo(){const a=new Map;for(const e of this.bancos){if(this.bancoFilter&&String(e.id)!==String(this.bancoFilter)||this.tipoContaFilter&&String(e.tipoCartaoId??"")!==String(this.tipoContaFilter))continue;const o=String(e.id),r=String(e.tipoCartaoId??"null"),s=`${o}-${r}`,d=this.tiposConta.find(_=>String(_.id)===r)?.nomeTipoCartao??"\u2014",c=this.extratos.reduce((_,f)=>f.bancoId==e.id?_+("ENTRADA"===String(f.tipoLancamento).toUpperCase()||"Entrada"===f.tipoLancamento?Number(f.valor):0):_,0),u=this.extratos.reduce((_,f)=>f.bancoId==e.id?_+("SAIDA"===String(f.tipoLancamento??"").normalize("NFD").replace(/[\u0300-\u036f]/g,"").toUpperCase()?Number(f.valor):0):_,0);a.has(s)||a.set(s,{bancoId:o,bancoNome:e.nomeBanco,tipoCartaoId:e.tipoCartaoId?String(e.tipoCartaoId):"null",tipoContaNome:d??"\u2014",totalEntrada:0,totalSaida:0});const m=a.get(s);m.totalEntrada+=c,m.totalSaida+=u}return Array.from(a.values())}onToggleToolbar(){this.showToolbar=!this.showToolbar}openImportModal(){this.selectedBancoId="",this.selectedBancoNome="",this.selectedTipoContaId="",this.showImportModal=!0}closeImportModal(){this.importLoading||(this.showImportModal=!1)}onBancoModalChange(a){this.selectedBancoId=a;const e=this.bancos.find(o=>String(o.id)===String(a));this.selectedBancoNome=e?.nomeBanco??"",this.selectedTipoContaId=e?.tipoCartaoId?String(e.tipoCartaoId):""}onFileSelected(a){var e=this;return(0,g.A)(function*(){const r=a.target.files?.[0];r&&(e.file=r)})()}onSave(a){var e=this;return(0,g.A)(function*(){e.file||e.setAlert("error","Nenhum arquivo selecionado.");const o=a.target;if(!e.selectedBancoId)return e.setAlert("error","Informe o banco antes de continuar."),void(o.value="");try{e.importLoading=!0,yield e.extratoItemService.importExtrato(e.file,{id:Number(e.selectedBancoId),nomeBanco:e.selectedBancoNome,tipoCartaoId:e.selectedTipoContaId?Number(e.selectedTipoContaId):null}),e.setAlert("success","Extrato importado com sucesso!"),e.showImportModal=!1,yield e.refresh()}catch{e.setAlert("error","Falha ao importar arquivo.")}finally{e.importLoading=!1,o.value=""}})()}openManualModal(){this.manualForm={dataMovimentacao:(0,h.vh)(),tipo:"SAIDA",valor:"",bancoId:"",tipoCartaoId:"",tipoCartaoNome:"",pessoaTransacao:"",categoriaId:"",descricao:"",observacao:"",parcelado:!1,totalParcelas:"",numeroParcela:"1",grupoParcelamentoId:""},this.showManualModal=!0}closeManualModal(){this.savingManual||(this.showManualModal=!1)}maskValueTyping(a){this.maskValueTyping(a)}setManual(a,e){if(this.manualForm[a]=e,"bancoId"===a){const r=this.bancos.find(s=>String(s.id)===String(e))?.tipoCartao??"";r&&"string"!=typeof r?(this.manualForm.tipoCartaoId=String(r.id),this.manualForm.tipoCartaoNome=r.nomeTipoCartao):(this.manualForm.tipoCartaoId="",this.manualForm.tipoCartaoNome="")}}get isCreditoSelecionado(){if(!this.manualForm.tipoCartaoId)return!1;const a=this.tiposConta.find(r=>String(r.id)===String(this.manualForm.tipoCartaoId));if(!a)return!1;const e=a.ehCredito??a.EhCredito??a.isCredito??a.IsCredito;if("boolean"==typeof e)return e;const o=String(a.nomeTipoCartao??a.NomeTipoCartao??"");return/cr[e\xe9]dito/i.test(o)}saveManualItem(){var a=this;return(0,g.A)(function*(){if(a.manualForm.bancoId)if(a.manualForm.tipoCartaoId)if(a.manualForm.valor){if(a.isCreditoSelecionado&&a.manualForm.parcelado){const e=Number(a.manualForm.totalParcelas),o=Number(a.manualForm.numeroParcela);if(!e||e<2)return void a.setAlert("error","Total de parcelas deve ser >= 2.");if(!o||o<1||o>e)return void a.setAlert("error","N\xfamero da parcela inv\xe1lido.")}try{a.savingManual=!0,console.log("this.manualForm",a.manualForm);const e={extratoBancarioId:null,dataMovimentacao:a.manualForm.dataMovimentacao,valor:(0,h.Yj)(a.manualForm.valor),tipoLancamento:a.manualForm.tipo,bancoId:Number(a.manualForm.bancoId),tipoCartaoId:Number(a.manualForm.tipoCartaoId),nomePessoaTransacao:(a.manualForm.pessoaTransacao||"").trim()||null,categoriaId:a.manualForm.categoriaId?Number(a.manualForm.categoriaId):null,descricao:(a.manualForm.descricao||"").trim()||null,observacao:(a.manualForm.observacao||"").trim()||null,ehParcelado:!!a.isCreditoSelecionado&&!!a.manualForm.parcelado,quantidadeParcelas:a.isCreditoSelecionado&&a.manualForm.parcelado?Number(a.manualForm.totalParcelas):null,parcelaAtual:a.isCreditoSelecionado&&a.manualForm.parcelado?Number(a.manualForm.numeroParcela):null,grupoParcelamentoId:a.isCreditoSelecionado&&a.manualForm.parcelado&&a.manualForm.grupoParcelamentoId?.trim()?a.manualForm.grupoParcelamentoId.trim():null};yield a.extratoItemService.createExtratoManualItem(e),a.setAlert("success","Item manual adicionado com sucesso!"),a.showManualModal=!1,yield a.refresh()}catch(e){a.setAlert("error",e?.error?.message||"Falha ao adicionar item manual.")}finally{a.savingManual=!1}}else a.setAlert("error","Informe um valor v\xe1lido.");else a.setAlert("error","Tipo de conta/cart\xe3o n\xe3o identificado. Verifique o banco.");else a.setAlert("error","Selecione um banco.")})()}goToDetalhe(a){console.log("row",a),this.router.navigate(["extrato-bancario/ExtratoBancarioDetalhe"],{queryParams:{month:this.monthFilter,bancoId:a.bancoId,tipoContaId:a.tipoCartaoId}})}trackById(a,e){return e.id}setAlert(a,e){this.alert={type:a,message:e},setTimeout(()=>this.alert={type:"",message:""},4e3)}money(a){return function at(n){return new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(Number(n)||0)}(a)}static{this.\u0275fac=function(e){return new(e||n)(t.rXU(F.Ix),t.rXU(M),t.rXU(R.l),t.rXU(y.D),t.rXU(k.g),t.rXU(E.M),t.rXU(T.J))}}static{this.\u0275cmp=t.VBU({type:n,selectors:[["app-extrato-bancario-resumo"]],decls:69,vars:15,consts:[[1,"page-wrapper"],[1,"page-body"],[1,"container-xl"],["class","alert",3,"alert-success","alert-danger","alert-warning",4,"ngIf"],[1,"d-flex","align-items-center","justify-content-between","mb-3"],[1,"text-muted","small"],[1,"m-0"],[1,"d-flex","gap-2"],[1,"btn","btn-primary",3,"click"],[1,"btn","btn-outline-primary",3,"click"],["type","button",1,"btn","btn-outline-secondary",3,"click"],[1,"collapse"],[1,"d-flex","justify-content-end","mt-2"],[1,"btn-list"],["type","button",1,"btn","btn-outline-secondary","btn-lg-icon",3,"click"],[1,"card","shadow-sm","mb-3"],[1,"card-body"],[1,"row","g-3","align-items-end"],[1,"col-12","col-md-4","col-lg-3"],[1,"form-label","text-muted","mb-1"],["type","month",1,"form-control",3,"ngModel","ngModelChange"],[1,"form-select",3,"ngModel","ngModelChange","change"],["value",""],[3,"value",4,"ngFor","ngForOf"],[1,"form-select",3,"ngModel","ngModelChange"],[1,"card","shadow-sm","border-0"],[1,"table-responsive"],[1,"table","table-vcenter","table-hover","mb-0"],[1,"bg-body-tertiary","bg-body","sticky-top"],[1,"border-bottom"],[1,"text-end"],[1,"text-center"],[4,"ngIf"],[4,"ngFor","ngForOf","ngForTrackBy"],[3,"mesExtrato","closed",4,"ngIf"],[1,"alert"],[3,"value"],["colspan","7",1,"text-center","text-secondary","py-4"],[1,"text-end","text-success","fw-bold"],[1,"text-end","text-danger","fw-bold"],[1,"btn-list","d-inline-flex"],["type","button","title","Salvar",1,"btn","btn-icon","btn-soft-success",3,"click"],["tabindex","-1","role","dialog",1,"modal","show","d-block"],["role","document",1,"modal-dialog","modal-md",2,"margin-top","100px"],[1,"modal-content"],[1,"modal-header"],[1,"modal-title"],["type","button",1,"btn","btn-sm","btn-outline-secondary",3,"disabled","click"],[1,"modal-body"],[1,"mb-3"],[1,"form-label"],[1,"form-select",3,"value","disabled","change"],["disabled","",1,"form-select",3,"value"],[1,"text-muted"],[1,"mb-2"],["type","file","accept",".ofx,.csv,.xls,.xlsx,.txt,.pdf",1,"form-control",3,"disabled","change"],[1,"modal-footer"],[1,"btn","btn-secondary",3,"disabled","click"],[1,"modal-backdrop","fade","show"],["role","document",1,"modal-dialog","modal-lg",2,"margin-top","100px"],[1,"modal-header","justify-content-between","p-3"],[1,"row","g-3"],[1,"col-12","col-md-4"],["type","date",1,"form-control",3,"value","input"],[1,"form-select",3,"value","change"],["value","Entrada"],["value","Sa\xedda"],["type","text","inputmode","decimal","appMoneyMaskBR","",1,"form-control",3,"value","input"],[1,"col-12","col-md-6"],["disabled","",1,"form-select",3,"ngModel"],[3,"ngValue"],["type","text",1,"form-control",3,"value","input"],[1,"col-12"],["rows","3",1,"form-control",3,"value","input"],[1,"btn","btn-primary",3,"disabled","click"],[1,"form-check","mt-2"],["type","checkbox",1,"form-check-input",3,"checked","change"],[1,"form-check-label"],["type","number","min","2",1,"form-control",3,"value","input"],["type","number","min","1",1,"form-control",3,"value","input"],[3,"mesExtrato","closed"]],template:function(e,o){1&e&&(t.j41(0,"div",0)(1,"div",1)(2,"div",2),t.DNE(3,V,2,7,"div",3),t.j41(4,"div",4)(5,"div")(6,"div",5),t.EFF(7,"Financeiro"),t.k0s(),t.j41(8,"h3",6),t.EFF(9,"Extrato Banc\xe1rio (Resumo)"),t.k0s()(),t.j41(10,"div",7)(11,"button",8),t.bIt("click",function(){return o.openImportModal()}),t.EFF(12,"Importar Extrato"),t.k0s(),t.j41(13,"button",9),t.bIt("click",function(){return o.openManualModal()}),t.EFF(14,"Adicionar item"),t.k0s(),t.j41(15,"button",10),t.bIt("click",function(){return o.onToggleToolbar()}),t.EFF(16," \u2304 "),t.k0s()()(),t.j41(17,"div",11)(18,"div",12)(19,"div",13)(20,"button",14),t.bIt("click",function(){return o.refresh()}),t.EFF(21,"\u27f3 Atualizar"),t.k0s(),t.j41(22,"button",14),t.bIt("click",function(){return o.refresh()}),t.EFF(23,"\u27f3 Relat\xf3rio Mensal"),t.k0s(),t.j41(24,"button",14),t.bIt("click",function(){return o.showModalImportacoesMensais=!0}),t.EFF(25,"\u27f3 Importa\xe7\xf5es mensais"),t.k0s()()()(),t.j41(26,"div",15)(27,"div",16)(28,"div",17)(29,"div",18)(30,"label",19),t.EFF(31,"M\xeas"),t.k0s(),t.j41(32,"input",20),t.bIt("ngModelChange",function(s){return o.monthFilter=s})("ngModelChange",function(){return o.refresh()}),t.k0s()(),t.j41(33,"div",18)(34,"label",19),t.EFF(35,"Banco"),t.k0s(),t.j41(36,"select",21),t.bIt("ngModelChange",function(s){return o.bancoFilter=s})("change",function(){return o.refresh()}),t.j41(37,"option",22),t.EFF(38,"Todos"),t.k0s(),t.DNE(39,P,2,2,"option",23),t.k0s()(),t.j41(40,"div",18)(41,"label",19),t.EFF(42,"Tipo Conta"),t.k0s(),t.j41(43,"select",24),t.bIt("ngModelChange",function(s){return o.tipoContaFilter=s}),t.j41(44,"option",22),t.EFF(45,"Todos"),t.k0s(),t.DNE(46,Y,2,2,"option",23),t.k0s()()()()(),t.j41(47,"div",25)(48,"div",26)(49,"table",27)(50,"thead",28)(51,"tr",29)(52,"th"),t.EFF(53,"Banco"),t.k0s(),t.j41(54,"th"),t.EFF(55,"Tipo Conta"),t.k0s(),t.j41(56,"th",30),t.EFF(57,"Total Entradas"),t.k0s(),t.j41(58,"th",30),t.EFF(59,"Total Sa\xeddas"),t.k0s(),t.j41(60,"th",31),t.EFF(61,"A\xe7\xf5es"),t.k0s()()(),t.j41(62,"tbody"),t.DNE(63,A,3,0,"tr",32),t.DNE(64,X,3,0,"tr",32),t.DNE(65,O,2,1,"ng-container",33),t.k0s()()()(),t.DNE(66,q,36,10,"ng-container",32),t.DNE(67,Z,68,18,"ng-container",32),t.k0s()(),t.DNE(68,W,1,1,"app-modal-importacoes-mensais",34),t.k0s()),2&e&&(t.R7$(3),t.Y8G("ngIf",o.alert.message),t.R7$(14),t.AVh("show",o.showToolbar),t.R7$(15),t.Y8G("ngModel",o.monthFilter),t.R7$(4),t.Y8G("ngModel",o.bancoFilter),t.R7$(3),t.Y8G("ngForOf",o.bancos),t.R7$(4),t.Y8G("ngModel",o.tipoContaFilter),t.R7$(3),t.Y8G("ngForOf",o.tiposConta),t.R7$(17),t.Y8G("ngIf",o.loading),t.R7$(1),t.Y8G("ngIf",!o.loading&&0===o.resumo.length),t.R7$(1),t.Y8G("ngForOf",o.resumo)("ngForTrackBy",o.trackById),t.R7$(1),t.Y8G("ngIf",o.showImportModal),t.R7$(1),t.Y8G("ngIf",o.showManualModal),t.R7$(1),t.Y8G("ngIf",o.showModalImportacoesMensais))},dependencies:[b.Sq,b.bT,l.xH,l.y7,l.me,l.wz,l.BC,l.vS,j,w],encapsulation:2})}}return n})();var ot=p(8359),x=p(4772);let nt=(()=>{class n{constructor(a){this.api=a}list(){return this.api.get("/GetPessoaMovimentacao").then(a=>a?.data??a??[])}GetPessoaMovimentacaoById(a){return this.api.get("/GetPessoaMovimentacaoById",a)}create(a){return this.api.post("/CreatePessoaMovimentacao",a)}update(a,e){return this.api.put("/UpdatePessoaMovimentacao",{...e})}delete(a){return this.api.delete("/DeletePessoaMovimentacao",a)}static{this.\u0275fac=function(e){return new(e||n)(t.KVO(v.G))}}static{this.\u0275prov=t.jDH({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();function rt(n,i){1&n&&(t.j41(0,"div",16),t.nrm(1,"span",17),t.EFF(2," Carregando... "),t.k0s())}function it(n,i){if(1&n&&(t.j41(0,"div",18),t.EFF(1),t.k0s()),2&n){const a=t.XpG();t.R7$(1),t.SpI(" ",a.errorMsg," ")}}function st(n,i){1&n&&(t.j41(0,"tr")(1,"td",26),t.EFF(2,"Nenhuma pessoa cadastrada."),t.k0s()())}function lt(n,i){if(1&n&&(t.j41(0,"option",29),t.EFF(1),t.k0s()),2&n){const a=i.$implicit;t.Y8G("ngValue",a.id),t.R7$(1),t.SpI(" ",a.name," ")}}function ct(n,i){if(1&n&&(t.j41(0,"option",29),t.EFF(1),t.k0s()),2&n){const a=i.$implicit;t.Y8G("ngValue",a.id),t.R7$(1),t.SpI(" ",a.nomeTipoMovimentacao," ")}}function dt(n,i){if(1&n){const a=t.RV6();t.j41(0,"tr")(1,"td")(2,"input",27),t.bIt("ngModelChange",function(o){const s=t.eBV(a).$implicit;return t.Njj(s.nomePessoa=o)}),t.k0s()(),t.j41(3,"td")(4,"select",28),t.bIt("ngModelChange",function(o){const s=t.eBV(a).$implicit;return t.Njj(s.categoriaId=o)}),t.j41(5,"option",29),t.EFF(6,"\u2014"),t.k0s(),t.DNE(7,lt,2,2,"option",30),t.k0s()(),t.j41(8,"td")(9,"select",28),t.bIt("ngModelChange",function(o){const s=t.eBV(a).$implicit;return t.Njj(s.tipoMovimentacaoId=o)}),t.j41(10,"option",29),t.EFF(11,"\u2014"),t.k0s(),t.DNE(12,ct,2,2,"option",30),t.k0s()(),t.j41(13,"td",31)(14,"div",32)(15,"button",33),t.bIt("click",function(){const r=t.eBV(a).$implicit,s=t.XpG(2);return t.Njj(s.saveRow(r))}),t.EFF(16),t.k0s(),t.j41(17,"button",34),t.bIt("click",function(){const r=t.eBV(a).$implicit,s=t.XpG(2);return t.Njj(s.removeRow(r))}),t.EFF(18," Excluir "),t.k0s()()()()}if(2&n){const a=i.$implicit,e=t.XpG(2);t.R7$(2),t.Y8G("ngModel",a.nomePessoa),t.R7$(2),t.Y8G("ngModel",a.categoriaId),t.R7$(1),t.Y8G("ngValue",null),t.R7$(2),t.Y8G("ngForOf",e.categorias),t.R7$(2),t.Y8G("ngModel",a.tipoMovimentacaoId),t.R7$(1),t.Y8G("ngValue",null),t.R7$(2),t.Y8G("ngForOf",e.tiposMovimentacao),t.R7$(3),t.Y8G("disabled",e.savingIds.has(a.id)),t.R7$(1),t.SpI(" ",e.savingIds.has(a.id)?"Salvando...":"Salvar"," "),t.R7$(1),t.Y8G("disabled",e.savingIds.has(a.id))}}function mt(n,i){if(1&n&&(t.j41(0,"div",19)(1,"table",20)(2,"thead",21)(3,"tr")(4,"th",22),t.EFF(5,"Nome"),t.k0s(),t.j41(6,"th",22),t.EFF(7,"Categoria"),t.k0s(),t.j41(8,"th",22),t.EFF(9,"Tipo Movimenta\xe7\xe3o"),t.k0s(),t.j41(10,"th",23),t.EFF(11,"A\xe7\xf5es"),t.k0s()()(),t.j41(12,"tbody"),t.DNE(13,st,3,0,"tr",24),t.DNE(14,dt,19,10,"tr",25),t.k0s()()()),2&n){const a=t.XpG();t.R7$(13),t.Y8G("ngIf",0===a.rows.length),t.R7$(1),t.Y8G("ngForOf",a.rows)("ngForTrackBy",a.trackById)}}let ut=(()=>{class n{constructor(a,e,o){this.pessoaService=a,this.categoriaService=e,this.tipoMovService=o,this.closed=new t.bkB,this.loading=!1,this.errorMsg="",this.categorias=[],this.tiposMovimentacao=[],this.rows=[],this.savingIds=new Set,this.trackById=(r,s)=>s.id}ngOnInit(){var a=this;return(0,g.A)(function*(){yield a.loadAll()})()}loadAll(){var a=this;return(0,g.A)(function*(){a.loading=!0,a.errorMsg="";try{const[e,o,r]=yield Promise.all([a.categoriaService.list(),a.tipoMovService.list(),a.pessoaService.list()]);a.categorias=e??[],a.tiposMovimentacao=o??[],a.rows=(r??[]).map(s=>({...s}))}catch(e){a.errorMsg=e?.error?.message||e?.message||"Erro ao carregar dados."}finally{a.loading=!1}})()}close(a=!1){this.closed.emit({reload:a})}addRow(){const a=-Date.now();this.rows=[{id:a,nomePessoa:"",categoriaId:null,tipoMovimentacaoId:null},...this.rows]}saveRow(a){var e=this;return(0,g.A)(function*(){if(e.errorMsg="",a.nomePessoa?.trim()){e.savingIds.add(a.id);try{if(a.id<0){const o=yield e.pessoaService.create({nomePessoa:a.nomePessoa.trim(),categoriaId:a.categoriaId??null,tipoMovimentacaoId:a.tipoMovimentacaoId??null});e.rows=e.rows.map(r=>r.id===a.id?{...o}:r)}else yield e.pessoaService.update(a.id,{id:a.id,nomePessoa:a.nomePessoa.trim(),categoriaId:a.categoriaId??null,tipoMovimentacaoId:a.tipoMovimentacaoId??null})}catch(o){e.errorMsg=o?.error?.message||o?.message||"Erro ao salvar."}finally{e.savingIds.delete(a.id)}}else e.errorMsg="Informe o nome da pessoa."})()}removeRow(a){var e=this;return(0,g.A)(function*(){if(e.errorMsg="",a.id<0)e.rows=e.rows.filter(o=>o.id!==a.id);else if(confirm(`Excluir "${a.nomePessoa}"?`)){e.savingIds.add(a.id);try{yield e.pessoaService.delete(a.id),e.rows=e.rows.filter(o=>o.id!==a.id)}catch(o){e.errorMsg=o?.error?.message||o?.message||"Erro ao excluir."}finally{e.savingIds.delete(a.id)}}})()}static{this.\u0275fac=function(e){return new(e||n)(t.rXU(nt),t.rXU(E.M),t.rXU(x.V))}}static{this.\u0275cmp=t.VBU({type:n,selectors:[["app-modal-configuracao-vinculo-pessoa"]],outputs:{closed:"closed"},decls:30,vars:3,consts:[[1,"modal-backdrop-custom",3,"click"],["role","dialog","aria-modal","true",1,"modal-custom"],[1,"modal-card","card"],[1,"card-header","d-flex","align-items-center","justify-content-between"],[1,"card-title","m-0"],[1,"d-flex","gap-2"],[1,"btn","btn-sm","btn-outline-primary",3,"click"],["type","button","aria-label","Fechar",1,"btn-close",3,"click"],[1,"card-body","modal-body-scroll"],["class","text-primary",4,"ngIf"],["class","alert alert-danger py-2",4,"ngIf"],["class","table-responsive",4,"ngIf"],[1,"form-text","mt-2"],[1,"card-footer","d-flex","justify-content-end","gap-2"],[1,"btn","btn-outline-secondary",3,"click"],[1,"btn","btn-primary",3,"click"],[1,"text-primary"],[1,"spinner-border","spinner-border-sm","me-2"],[1,"alert","alert-danger","py-2"],[1,"table-responsive"],[1,"table","table-hover","align-middle","mb-0"],[1,"bg-body-tertiary"],[2,"min-width","220px"],[1,"text-end",2,"width","160px"],[4,"ngIf"],[4,"ngFor","ngForOf","ngForTrackBy"],["colspan","4",1,"text-center","text-muted","py-4"],["placeholder","Ex.: Jo\xe3o",1,"form-control","form-control-sm",3,"ngModel","ngModelChange"],[1,"form-select","form-select-sm",3,"ngModel","ngModelChange"],[3,"ngValue"],[3,"ngValue",4,"ngFor","ngForOf"],[1,"text-end"],[1,"d-inline-flex","gap-2"],[1,"btn","btn-sm","btn-primary",3,"disabled","click"],[1,"btn","btn-sm","btn-outline-danger",3,"disabled","click"]],template:function(e,o){1&e&&(t.j41(0,"div",0),t.bIt("click",function(){return o.close(!1)}),t.k0s(),t.j41(1,"div",1)(2,"div",2)(3,"div",3)(4,"h3",4),t.EFF(5,"Pessoas Cadastradas"),t.k0s(),t.j41(6,"div",5)(7,"button",6),t.bIt("click",function(){return o.addRow()}),t.EFF(8," + Nova pessoa "),t.k0s(),t.j41(9,"button",7),t.bIt("click",function(){return o.close(!1)}),t.k0s()()(),t.j41(10,"div",8),t.DNE(11,rt,3,0,"div",9),t.DNE(12,it,2,1,"div",10),t.DNE(13,mt,15,3,"div",11),t.j41(14,"div",12),t.EFF(15," Dica: preencha "),t.j41(16,"strong"),t.EFF(17,"Nome"),t.k0s(),t.EFF(18," e opcionalmente vincule "),t.j41(19,"strong"),t.EFF(20,"Categoria"),t.k0s(),t.EFF(21," e "),t.j41(22,"strong"),t.EFF(23,"Tipo"),t.k0s(),t.EFF(24,". "),t.k0s()(),t.j41(25,"div",13)(26,"button",14),t.bIt("click",function(){return o.close(!1)}),t.EFF(27,"Fechar"),t.k0s(),t.j41(28,"button",15),t.bIt("click",function(){return o.close(!0)}),t.EFF(29,"Concluir"),t.k0s()()()()),2&e&&(t.R7$(11),t.Y8G("ngIf",o.loading),t.R7$(1),t.Y8G("ngIf",o.errorMsg),t.R7$(1),t.Y8G("ngIf",!o.loading))},dependencies:[b.Sq,b.bT,l.xH,l.y7,l.me,l.wz,l.BC,l.vS],styles:['@charset "UTF-8";.modal-backdrop-custom[_ngcontent-%COMP%]{position:fixed;inset:0;background:rgba(0,0,0,.4);z-index:1040}.modal-custom[_ngcontent-%COMP%]{position:fixed;inset:0;display:grid;place-items:center;z-index:1050}.modal-custom[_ngcontent-%COMP%]{position:fixed;inset:0;display:flex;align-items:center;justify-content:center;padding:16px;z-index:1050}.modal-card[_ngcontent-%COMP%]{width:min(1100px,100%);max-height:calc(80vh - 32px);display:flex;flex-direction:column;overflow:hidden}.modal-card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%], .modal-card[_ngcontent-%COMP%]   .card-footer[_ngcontent-%COMP%]{flex:0 0 auto}.modal-body-scroll[_ngcontent-%COMP%]{flex:1 1 auto;overflow:auto;-webkit-overflow-scrolling:touch}']})}}return n})();function pt(n,i){if(1&n&&(t.j41(0,"div",55),t.EFF(1),t.k0s()),2&n){const a=t.XpG();t.AVh("alert-success","success"===a.alert.type)("alert-danger","error"===a.alert.type)("alert-warning","warning"===a.alert.type),t.R7$(1),t.SpI(" ",a.alert.message," ")}}function gt(n,i){1&n&&(t.j41(0,"span",30),t.EFF(1,"(Cart\xe3o de cr\xe9dito)"),t.k0s())}function _t(n,i){if(1&n&&(t.j41(0,"option",20),t.EFF(1),t.k0s()),2&n){const a=i.$implicit;t.Y8G("ngValue",a),t.R7$(1),t.JRh(a)}}function ft(n,i){if(1&n&&(t.j41(0,"option",20),t.EFF(1),t.k0s()),2&n){const a=i.$implicit;t.Y8G("ngValue",a.id),t.R7$(1),t.SpI(" ",a.name," ")}}function ht(n,i){1&n&&(t.qex(0),t.j41(1,"th"),t.EFF(2,"Parcela"),t.k0s(),t.j41(3,"th"),t.EFF(4,"Fatura"),t.k0s(),t.bVm())}function bt(n,i){if(1&n){const a=t.RV6();t.qex(0),t.nrm(1,"th"),t.j41(2,"th")(3,"input",56),t.bIt("ngModelChange",function(o){t.eBV(a);const r=t.XpG();return t.Njj(r.tableFilters.fatura=o)}),t.k0s()(),t.bVm()}if(2&n){const a=t.XpG();t.R7$(3),t.Y8G("ngModel",a.tableFilters.fatura)}}function Ft(n,i){if(1&n&&(t.j41(0,"option",57),t.EFF(1),t.k0s()),2&n){const a=i.$implicit;t.Y8G("value",a.id),t.R7$(1),t.JRh(a.name)}}function vt(n,i){if(1&n&&(t.j41(0,"option",57),t.EFF(1),t.k0s()),2&n){const a=i.$implicit;t.Y8G("value",a.id),t.R7$(1),t.SpI(" ",a.descricao," ")}}function Et(n,i){if(1&n&&(t.j41(0,"tr")(1,"td",58),t.nrm(2,"span",59),t.EFF(3," Carregando detalhes... "),t.k0s()()),2&n){const a=t.XpG();t.R7$(1),t.BMQ("colspan",a.isCreditCard?11:9)}}function Ct(n,i){if(1&n&&(t.j41(0,"tr")(1,"td",60),t.EFF(2," Nenhum lan\xe7amento encontrado com os filtros aplicados. "),t.k0s()()),2&n){const a=t.XpG();t.R7$(1),t.BMQ("colspan",a.isCreditCard?11:9)}}function It(n,i){if(1&n&&(t.qex(0),t.EFF(1),t.bVm()),2&n){const a=t.XpG(3).$implicit;t.R7$(1),t.Lme(" ",a.parcelaAtual,"/",a.quantidadeParcelas," ")}}function Mt(n,i){1&n&&t.EFF(0,"\u2014")}function kt(n,i){if(1&n&&(t.qex(0),t.j41(1,"td"),t.DNE(2,It,2,2,"ng-container",61),t.DNE(3,Mt,1,0,"ng-template",null,66,t.C5r),t.k0s(),t.j41(5,"td"),t.EFF(6),t.k0s(),t.bVm()),2&n){const a=t.sdS(4),e=t.XpG(2).$implicit;t.R7$(2),t.Y8G("ngIf",e.parcelaAtual&&e.quantidadeParcelas)("ngIfElse",a),t.R7$(4),t.JRh(e.numeroFatura||"\u2014")}}function jt(n,i){if(1&n){const a=t.RV6();t.qex(0),t.j41(1,"td"),t.EFF(2),t.nI1(3,"date"),t.k0s(),t.j41(4,"td"),t.EFF(5),t.k0s(),t.DNE(6,kt,7,3,"ng-container",39),t.j41(7,"td"),t.EFF(8),t.k0s(),t.j41(9,"td"),t.EFF(10),t.k0s(),t.j41(11,"td"),t.EFF(12),t.k0s(),t.j41(13,"td"),t.EFF(14),t.k0s(),t.j41(15,"td",63),t.EFF(16),t.k0s(),t.j41(17,"td",51)(18,"div",64)(19,"button",65),t.bIt("click",function(){t.eBV(a);const o=t.XpG().$implicit,r=t.XpG();return t.Njj(r.startEdit(o))}),t.EFF(20,"Editar"),t.k0s()()(),t.bVm()}if(2&n){const a=t.XpG().$implicit,e=t.XpG();t.R7$(2),t.JRh(t.i5U(3,12,a.dataMovimentacao,"dd/MM/yyyy")),t.R7$(3),t.JRh(a.tipoLancamento||"\u2014"),t.R7$(1),t.Y8G("ngIf",e.isCreditCard),t.R7$(2),t.JRh((null==a.categoria?null:a.categoria.name)||"\u2014"),t.R7$(2),t.JRh(a.descricao||"\u2014"),t.R7$(2),t.JRh((null==a.tipoMovimentacao?null:a.tipoMovimentacao.nomeTipoMovimentacao)||"\u2014"),t.R7$(2),t.JRh(a.nomePessoaTransacao||"\u2014"),t.R7$(1),t.AVh("text-danger","Sa\xedda"==a.tipoLancamento)("text-success","Entrada"==a.tipoLancamento),t.R7$(1),t.SpI(" ",e.money(a.valor)," ")}}function xt(n,i){if(1&n&&(t.j41(0,"option",57),t.EFF(1),t.k0s()),2&n){const a=i.$implicit;t.Y8G("value",a),t.R7$(1),t.JRh(a)}}function Rt(n,i){1&n&&(t.qex(0),t.j41(1,"td")(2,"div",78),t.nrm(3,"input",79),t.j41(4,"span",30),t.EFF(5,"/"),t.k0s(),t.nrm(6,"input",80),t.k0s()(),t.j41(7,"td"),t.nrm(8,"input",81),t.k0s(),t.bVm())}function yt(n,i){if(1&n&&(t.j41(0,"option",57),t.EFF(1),t.k0s()),2&n){const a=i.$implicit;t.Y8G("value",a.id),t.R7$(1),t.JRh(a.name)}}function Tt(n,i){if(1&n&&(t.j41(0,"option",57),t.EFF(1),t.k0s()),2&n){const a=i.$implicit;t.Y8G("value",a.id),t.R7$(1),t.SpI(" ",a.nomeTipoMovimentacao," ")}}function Bt(n,i){if(1&n){const a=t.RV6();t.qex(0,68),t.j41(1,"td"),t.nrm(2,"input",69),t.k0s(),t.j41(3,"td")(4,"select",70),t.DNE(5,xt,2,2,"option",46),t.k0s()(),t.DNE(6,Rt,9,0,"ng-container",39),t.j41(7,"td")(8,"select",71)(9,"option",45),t.EFF(10,"\u2014"),t.k0s(),t.DNE(11,yt,2,2,"option",46),t.k0s()(),t.j41(12,"td"),t.nrm(13,"input",72),t.k0s(),t.j41(14,"td")(15,"select",73)(16,"option",45),t.EFF(17,"\u2014"),t.k0s(),t.DNE(18,Tt,2,2,"option",46),t.k0s()(),t.j41(19,"td"),t.nrm(20,"input",74),t.k0s(),t.j41(21,"td",40),t.nrm(22,"input",75),t.k0s(),t.j41(23,"td",51)(24,"div",64)(25,"button",76),t.bIt("click",function(){t.eBV(a);const o=t.XpG(2).$implicit,r=t.XpG();return t.Njj(r.saveEdit(o))}),t.EFF(26),t.k0s(),t.j41(27,"button",77),t.bIt("click",function(){t.eBV(a);const o=t.XpG(2).$implicit,r=t.XpG();return t.Njj(r.cancelEdit(o))}),t.EFF(28," Cancelar "),t.k0s()()(),t.bVm()}if(2&n){const a=i.ngIf,e=t.XpG(2).$implicit,o=t.XpG();t.Y8G("formGroup",a),t.R7$(5),t.Y8G("ngForOf",o.tipoLancamentoOptions),t.R7$(1),t.Y8G("ngIf",o.isCreditCard),t.R7$(5),t.Y8G("ngForOf",o.categorias),t.R7$(7),t.Y8G("ngForOf",o.tiposMovimentacao),t.R7$(7),t.Y8G("disabled",o.isSavingRow(e)),t.R7$(1),t.SpI(" ",o.isSavingRow(e)?"Salvando...":"Salvar"," "),t.R7$(1),t.Y8G("disabled",o.isSavingRow(e))}}function Gt(n,i){if(1&n&&t.DNE(0,Bt,29,8,"ng-container",67),2&n){const a=t.XpG().$implicit,e=t.XpG();t.Y8G("ngIf",e.rowForms.get(e.rowKey(a)))}}function Nt(n,i){if(1&n&&(t.j41(0,"tr"),t.DNE(1,jt,21,15,"ng-container",61),t.DNE(2,Gt,1,1,"ng-template",null,62,t.C5r),t.k0s()),2&n){const a=i.$implicit,e=t.sdS(3),o=t.XpG();t.R7$(1),t.Y8G("ngIf",!o.isEditing(a))("ngIfElse",e)}}function $t(n,i){1&n&&(t.j41(0,"span"),t.EFF(1,"(Cart\xe3o de cr\xe9dito)"),t.k0s())}function Dt(n,i){if(1&n){const a=t.RV6();t.qex(0),t.j41(1,"div",22)(2,"label",90),t.EFF(3,"Total de parcelas"),t.k0s(),t.j41(4,"input",110),t.bIt("ngModelChange",function(o){t.eBV(a);const r=t.XpG(3);return t.Njj(r.manualQuantidadeParcelas=o)}),t.k0s()(),t.j41(5,"div",111)(6,"div",107)(7,"input",112),t.bIt("ngModel",function(){t.eBV(a);const o=t.XpG(3);return t.Njj(o.manualGerarTodasParcelas)}),t.k0s(),t.j41(8,"label",113),t.EFF(9," Gerar todas as parcelas automaticamente "),t.k0s()()(),t.bVm()}if(2&n){const a=t.XpG(3);t.R7$(4),t.Y8G("ngModel",a.manualQuantidadeParcelas)("disabled",a.saving),t.R7$(3),t.Y8G("disabled",a.saving)}}function St(n,i){if(1&n){const a=t.RV6();t.qex(0),t.j41(1,"div",22)(2,"label",90),t.EFF(3,"N\xfamero da fatura (opcional)"),t.k0s(),t.j41(4,"input",105),t.bIt("ngModel",function(){t.eBV(a);const o=t.XpG(2);return t.Njj(o.manualNumeroFatura)}),t.k0s()(),t.j41(5,"div",106)(6,"div",107)(7,"input",108),t.bIt("ngModelChange",function(o){t.eBV(a);const r=t.XpG(2);return t.Njj(r.manualParcelado=o)}),t.k0s(),t.j41(8,"label",109),t.EFF(9,"Compra parcelada"),t.k0s()()(),t.DNE(10,Dt,10,3,"ng-container",39),t.bVm()}if(2&n){const a=t.XpG(2);t.R7$(4),t.Y8G("disabled",a.saving),t.R7$(3),t.Y8G("ngModel",a.manualParcelado)("disabled",a.saving),t.R7$(3),t.Y8G("ngIf",a.manualParcelado)}}function wt(n,i){if(1&n&&(t.j41(0,"option",57),t.EFF(1),t.k0s()),2&n){const a=i.$implicit;t.Y8G("value",a.id),t.R7$(1),t.SpI(" ",a.name," ")}}function Vt(n,i){if(1&n){const a=t.RV6();t.qex(0),t.j41(1,"div",82)(2,"div",83)(3,"div",84)(4,"div",85)(5,"h5",86),t.EFF(6," Adicionar lan\xe7amento manual "),t.DNE(7,$t,2,0,"span",39),t.k0s(),t.j41(8,"button",87),t.bIt("click",function(){t.eBV(a);const o=t.XpG();return t.Njj(o.closeAddModal())}),t.k0s()(),t.j41(9,"div",88)(10,"div",89)(11,"div",22)(12,"label",90),t.EFF(13,"Data"),t.k0s(),t.j41(14,"input",91),t.bIt("ngModelChange",function(o){t.eBV(a);const r=t.XpG();return t.Njj(r.manualData=o)}),t.k0s()(),t.j41(15,"div",22)(16,"label",90),t.EFF(17,"Tipo lan\xe7amento"),t.k0s(),t.j41(18,"select",92),t.bIt("ngModelChange",function(o){t.eBV(a);const r=t.XpG();return t.Njj(r.manualTipoLancamento=o)}),t.j41(19,"option",93),t.EFF(20,"Entrada"),t.k0s(),t.j41(21,"option",94),t.EFF(22,"Sa\xedda"),t.k0s()()(),t.j41(23,"div",22)(24,"label",90),t.EFF(25,"Valor"),t.k0s(),t.j41(26,"input",95),t.bIt("ngModelChange",function(o){t.eBV(a);const r=t.XpG();return t.Njj(r.manualValor=o)}),t.k0s()(),t.DNE(27,St,11,4,"ng-container",39),t.j41(28,"div",96)(29,"label",90),t.EFF(30,"Categoria"),t.k0s(),t.j41(31,"select",92),t.bIt("ngModelChange",function(o){t.eBV(a);const r=t.XpG();return t.Njj(r.manualCategoriaId=o)}),t.j41(32,"option",45),t.EFF(33,"Selecione..."),t.k0s(),t.DNE(34,wt,2,2,"option",46),t.k0s()(),t.j41(35,"div",96)(36,"label",90),t.EFF(37,"Pessoa transa\xe7\xe3o"),t.k0s(),t.j41(38,"input",97),t.bIt("ngModelChange",function(o){t.eBV(a);const r=t.XpG();return t.Njj(r.manualPessoa=o)}),t.k0s()(),t.j41(39,"div",98)(40,"label",90),t.EFF(41,"Descri\xe7\xe3o"),t.k0s(),t.j41(42,"input",97),t.bIt("ngModelChange",function(o){t.eBV(a);const r=t.XpG();return t.Njj(r.manualDescricao=o)}),t.k0s()(),t.j41(43,"div",98)(44,"label",90),t.EFF(45,"Observa\xe7\xe3o (manual)"),t.k0s(),t.j41(46,"textarea",99),t.bIt("ngModelChange",function(o){t.eBV(a);const r=t.XpG();return t.Njj(r.manualObservacao=o)}),t.k0s()(),t.j41(47,"div",96)(48,"label",90),t.EFF(49,"Identificador"),t.k0s(),t.j41(50,"input",100),t.bIt("ngModel",function(){t.eBV(a);const o=t.XpG();return t.Njj(o.manualIdentificador)}),t.k0s()()()(),t.j41(51,"div",101)(52,"button",102),t.bIt("click",function(){t.eBV(a);const o=t.XpG();return t.Njj(o.closeAddModal())}),t.EFF(53,"Cancelar"),t.k0s(),t.j41(54,"button",103),t.bIt("click",function(){t.eBV(a);const o=t.XpG();return t.Njj(o.handleSaveManual())}),t.EFF(55),t.k0s()()()()(),t.nrm(56,"div",104),t.bVm()}if(2&n){const a=t.XpG();t.R7$(7),t.Y8G("ngIf",a.isCreditCard),t.R7$(1),t.Y8G("disabled",a.saving),t.R7$(6),t.Y8G("ngModel",a.manualData)("disabled",a.saving),t.R7$(4),t.Y8G("ngModel",a.manualTipoLancamento)("disabled",a.saving),t.R7$(8),t.Y8G("ngModel",a.manualValor),t.R7$(1),t.Y8G("ngIf",a.isCreditCard),t.R7$(4),t.Y8G("ngModel",a.manualCategoriaId)("disabled",a.saving),t.R7$(3),t.Y8G("ngForOf",a.categorias),t.R7$(4),t.Y8G("ngModel",a.manualPessoa)("disabled",a.saving),t.R7$(4),t.Y8G("ngModel",a.manualDescricao)("disabled",a.saving),t.R7$(4),t.Y8G("ngModel",a.manualObservacao)("disabled",a.saving),t.R7$(4),t.Y8G("disabled",a.saving),t.R7$(2),t.Y8G("disabled",a.saving),t.R7$(2),t.Y8G("disabled",a.saving),t.R7$(1),t.SpI(" ",a.saving?"Salvando...":"Salvar"," ")}}function Pt(n,i){if(1&n){const a=t.RV6();t.j41(0,"app-modal-configuracao-vinculo-pessoa",114),t.bIt("closed",function(o){t.eBV(a);const r=t.XpG();return t.Njj(r.fecharConfigPessoas(o))}),t.k0s()}}function C(n){return new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(Number(n)||0)}function At(n,i){const[a,e,o]=n.split("-").map(Number),r=new Date(a,e-1+i,o);return`${r.getFullYear()}-${String(r.getMonth()+1).padStart(2,"0")}-${String(r.getDate()).padStart(2,"0")}`}const Xt=[{path:"",component:et},{path:"ExtratoBancarioDetalhe",component:(()=>{class n{constructor(a,e,o,r,s,d,c){this.route=a,this.router=e,this.categoriaService=o,this.tipoCartaoService=r,this.extratoItemService=s,this.fb=d,this.tipoMovimentacaoService=c,this.sub=new ot.yU,this.month="",this.bancoId=null,this.tipoContaId=null,this.tiposMovimentacao=[],this.loading=!1,this.extratos=[],this.localItems=[],this.categorias=[],this.tiposConta=[],this.alert={type:"",message:""},this.showModalConfigPessoas=!1,this.dateFrom="",this.dateTo="",this.tipoLancamentoFilter="",this.descricaoFilter="",this.pessoaFilter="",this.categoriaFilter="",this.minValue="",this.maxValue="",this.tableFilters={data:"",tipo:"",categoriaId:"",descricao:"",tipoMovimentacaoId:"",pessoa:"",minValor:"",maxValor:"",fatura:""},this.showAddModal=!1,this.saving=!1,this.manualData=(0,h.vh)(),this.manualValor="",this.manualTipoLancamento="Entrada",this.manualDescricao="",this.manualPessoa="",this.manualIdentificador="",this.manualCategoriaId="",this.manualObservacao="",this.manualParcelado=!1,this.manualQuantidadeParcelas=2,this.manualGerarTodasParcelas=!0,this.manualNumeroFatura="",this.rowForms=new Map,this.editingIds=new Set,this.savingRowIds=new Set,this.trackByRow=(u,m)=>this.rowKey(m)}ngOnInit(){var a=this;this.sub.add(this.route.queryParamMap.subscribe(function(){var e=(0,g.A)(function*(o){a.month=o.get("month")??"",a.bancoId=o.get("bancoId")?Number(o.get("bancoId")):null,a.tipoContaId=o.get("tipoContaId")?Number(o.get("tipoContaId")):null;const r=new Date(a.month+"-01T00:00:00");a.dateFrom=r.toISOString().substring(0,10);const s=new Date(r.getFullYear(),r.getMonth()+1,0);a.dateTo=s.toISOString().substring(0,10),yield a.loadCatalogos(),a.tipoLancamentoFilter||(a.tipoLancamentoFilter=""),a.categoriaFilter||(a.categoriaFilter=""),yield a.refresh()});return function(o){return e.apply(this,arguments)}}()))}ngOnDestroy(){this.sub.unsubscribe()}loadCatalogos(){var a=this;return(0,g.A)(function*(){try{const[e,o,r]=yield Promise.all([a.categoriaService.list(),a.tipoCartaoService.list(),a.tipoMovimentacaoService.list()]);a.categorias=e??[],a.tiposConta=o??[],a.tiposMovimentacao=r??[]}catch{a.setAlert("warning","N\xe3o foi poss\xedvel carregar cat\xe1logos.")}})()}abrirConfigPessoas(){this.showModalConfigPessoas=!0}fecharConfigPessoas(a){this.showModalConfigPessoas=!1,a?.reload&&this.refresh()}getTipoMovimentacaoId(a){const e=a.tipoMovimentacaoId??a.TipoMovimentacaoId??a.tipoMovimentacao?.id??"";return null==e?"":String(e)}refresh(){var a=this;return(0,g.A)(function*(){a.loading=!0;try{const e=yield a.extratoItemService.listExtratos(a.month,a.bancoId);a.extratos=Array.isArray(e)?e:[],a.rebuildForms()}catch{a.setAlert("error","Erro ao carregar detalhes.")}finally{a.loading=!1}})()}get items(){return[...this.localItems,...this.extratos]}get tipoContaSelecionada(){return this.tipoContaId?this.tiposConta.find(a=>String(a.id)===String(this.tipoContaId))??null:null}get isCreditCard(){const a=this.tipoContaSelecionada;if(!a)return!1;const e=a.isCredito??a.IsCredito??a.ehCredito??a.EhCredito??a.cartaoCredito??a.CartaoCredito;if("boolean"==typeof e)return e;const o=String(a.nomeTipoCartao??a.nome??a.Nome??a.descricao??a.Descricao??"");return/cr[e\xe9]dito/i.test(o)}get headerBancoNome(){const a=this.items?.[0];return a?a.bancoNome??a.banco?.nomeBanco??a.banco?.nome??(this.bancoId?`Banco #${this.bancoId}`:"Banco"):this.bancoId?`Banco #${this.bancoId}`:"Banco"}get headerTipoContaNome(){const a=this.items?.[0];return a?a.nomeTipoCartao??a.banco?.tipoCartao?.nomeTipoCartao??(this.tipoContaId?`Tipo #${this.tipoContaId}`:"Tipo Conta"):this.tipoContaId?`Tipo #${this.tipoContaId}`:"Tipo Conta"}get totalItens(){return this.filteredExtratos.length}get totalEntrada(){return this.filteredExtratos.reduce((a,e)=>{const o=Number(e.valor??e.Valor??0);return a+(o>0?o:0)},0)}get totalSaida(){return this.filteredExtratos.reduce((a,e)=>{const o=Number(e.valor??e.Valor??0);return a+(o<0?Math.abs(o):0)},0)}get totalValor(){return this.filteredExtratos.reduce((a,e)=>a+Number(e.valor??e.Valor??0),0)}get categoriaNomePorId(){const a=new Map;for(const e of this.categorias){const o=e.id??e.Id,r=e.nome??e.name??e.descricao??e.Descricao;null!=o&&a.set(String(o),r||`Categoria #${o}`)}return a}get tipoLancamentoOptions(){const a=new Set(["Sa\xedda","Entrada"]);for(const e of this.items){const o=e.tipoLancamento;o&&a.add(o)}return Array.from(a)}get filteredExtratos(){const a=this.tableFilters;return this.items.filter(e=>{const o=Number(e.valor??e.Valor??0);if(this.tipoContaId&&String(e.tipoCartaoId??e.tipoCartao?.id??e.tipoContaId??null)!==String(this.tipoContaId))return!1;if(this.dateFrom||this.dateTo){const c=e.dataMovimentacao,u=c?new Date(c):null;if(u&&!isNaN(u.getTime())){if(this.dateFrom){const m=new Date(this.dateFrom);if(m.setHours(0,0,0,0),u<m)return!1}if(this.dateTo){const m=new Date(this.dateTo);if(m.setHours(23,59,59,999),u>m)return!1}}}const s=String(e.tipoLancamento??"");if(this.tipoLancamentoFilter&&s!==this.tipoLancamentoFilter)return!1;const d=e.categoriaId??e.categoryId??e.categoria?.id??e.category?.id??null;if(this.categoriaFilter&&String(d)!==String(this.categoriaFilter))return!1;if(this.descricaoFilter.trim()){const c=this.descricaoFilter.trim().toLowerCase(),u=String(e.descricao||"").toLowerCase(),m=String(e.observacao||e.descricaoManual||"").toLowerCase();if(!u.includes(c)&&!m.includes(c))return!1}return!(this.pessoaFilter.trim()&&!String(e.nomePessoaTransacao||"").toLowerCase().includes(this.pessoaFilter.trim().toLowerCase())||""!==this.minValue&&o<Number(this.minValue)||""!==this.maxValue&&o>Number(this.maxValue)||a.data&&String(e.dataMovimentacao??"").substring(0,10)!==a.data||a.tipo&&!String(e.tipoLancamento??"").toLowerCase().includes(a.tipo.toLowerCase())||a.categoriaId&&String(d??"")!==String(a.categoriaId)||a.fatura&&this.isCreditCard&&!String(e.numeroFatura??"").toLowerCase().includes(a.fatura.toLowerCase())||a.descricao&&!String(e.descricao??"").toLowerCase().includes(a.descricao.toLowerCase())||a.tipoMovimentacaoId&&!String(e.observacao??e.descricaoManual??"").toLowerCase().includes(a.tipoMovimentacaoId.toLowerCase())||a.pessoa&&!String(e.nomePessoaTransacao??"").toLowerCase().includes(a.pessoa.toLowerCase())||""!==a.minValor&&o<Number(a.minValor)||""!==a.maxValor&&o>Number(a.maxValor))})}rowKey(a){const e=a?.id??a?.Id??a?.extratoId??a?.codigo;if(null!=e&&""!==String(e))return e;const o=a?.identificador??a?.grupoParcelamento??a?.GrupoParcelamento;return o?String(o):String(a?.dataMovimentacao??"")+"|"+String(a?.descricao??"")+"|"+String(a?.valor??"")}getCategoriaId(a){const e=a.categoriaId??a.categoryId??a.categoria?.id??a.category?.id??"";return null==e?"":String(e)}rebuildForms(){const a=new Set;for(const e of this.items){const o=this.rowKey(e);if(a.add(o),!this.rowForms.has(o)){const r=this.fb.group({dataMovimentacao:this.fb.control(String(e.dataMovimentacao??"").substring(0,10),{nonNullable:!0}),tipoLancamento:this.fb.control(String(e.tipoLancamento??""),{nonNullable:!0}),categoriaId:this.fb.control(this.getCategoriaId(e),{nonNullable:!0}),tipoMovimentacaoId:this.fb.control(this.getTipoMovimentacaoId(e),{nonNullable:!0}),descricao:this.fb.control(String(e.descricao??""),{nonNullable:!0}),nomePessoaTransacao:this.fb.control(String(e.nomePessoaTransacao??""),{nonNullable:!0}),valor:this.fb.control(C(e.valor??0),{nonNullable:!0}),numeroFatura:this.fb.control(String(e.numeroFatura??""),{nonNullable:!0}),parcelaAtual:this.fb.control(String(e.parcelaAtual??""),{nonNullable:!0}),quantidadeParcelas:this.fb.control(String(e.quantidadeParcelas??""),{nonNullable:!0})});this.rowForms.set(o,r)}}for(const e of Array.from(this.rowForms.keys()))a.has(e)||(this.rowForms.delete(e),this.editingIds.delete(e),this.savingRowIds.delete(e))}isEditing(a){return this.editingIds.has(this.rowKey(a))}startEdit(a){const e=this.rowKey(a);this.rowForms.has(e)||this.rebuildForms();const o=this.rowForms.get(e);o&&(this.editingIds.add(e),o.reset({dataMovimentacao:String(a.dataMovimentacao??"").substring(0,10),tipoLancamento:String(a.tipoLancamento??""),categoriaId:this.getCategoriaId(a),tipoMovimentacaoId:this.getTipoMovimentacaoId(a),descricao:String(a.descricao??""),nomePessoaTransacao:String(a.nomePessoaTransacao??""),valor:C(a.valor??0),numeroFatura:String(a.numeroFatura??""),parcelaAtual:String(a.parcelaAtual??""),quantidadeParcelas:String(a.quantidadeParcelas??"")}))}cancelEdit(a){const e=this.rowKey(a);this.editingIds.delete(e),this.rowForms.get(e)?.markAsPristine()}saveEdit(a){var e=this;return(0,g.A)(function*(){const o=e.rowKey(a),r=e.rowForms.get(o);if(!r)return;const s=Number(a?.id??a?.Id??0);if(s){e.savingRowIds.add(o);try{const d=e.toDecimalBR(r.controls.valor.value),c={Id:s,DataMovimentacao:r.controls.dataMovimentacao.value,Valor:d,TipoLancamento:r.controls.tipoLancamento.value,Descricao:r.controls.descricao.value||null,NomePessoaTransacao:r.controls.nomePessoaTransacao.value||null,Identificador:a?.identificador??a?.Identificador??null,BancoId:a?.bancoId??a?.BancoId??e.bancoId??null,CategoriaId:r.controls.categoriaId.value?Number(r.controls.categoriaId.value):null,TipoMovimentacaoId:r.controls.tipoMovimentacaoId.value?Number(r.controls.tipoMovimentacaoId.value):null,EhParcelado:a?.ehParcelado??a?.EhParcelado??null,ParcelaAtual:r.controls.parcelaAtual.value?Number(r.controls.parcelaAtual.value):null,QuantidadeParcelas:r.controls.quantidadeParcelas.value?Number(r.controls.quantidadeParcelas.value):null,TipoCartaoId:a?.tipoCartaoId??a?.TipoCartaoId??e.tipoContaId??null,UserId:a?.userId??a?.UserId??0,ChaveDescricao:a?.chaveDescricao??a?.ChaveDescricao??null,PessoaMovimentacaoId:a?.pessoaMovimentacaoId??a?.PessoaMovimentacaoId??null,AlteraVinculoPessoa:!0};yield e.extratoItemService.updateExtratoItem(c).then(()=>{e.setAlert("success","Linha atualizada!")}).catch(m=>{e.setAlert("error",m?.error?.message||m?.message||"Falha ao salvar edi\xe7\xe3o.")});const u=m=>m.map(_=>String(e.rowKey(_))===String(o)?{..._,...a,...c,valor:d}:_);e.localItems=u(e.localItems),e.extratos=u(e.extratos),e.rebuildForms(),e.editingIds.delete(o),r.markAsPristine(),e.setAlert("success","Linha atualizada!")}catch(d){e.setAlert("error",d?.error?.message||d?.message||"Falha ao salvar edi\xe7\xe3o.")}finally{e.savingRowIds.delete(o)}}else e.setAlert("error","Este item n\xe3o possui Id v\xe1lido para atualizar.")})()}toDecimalBR(a){if(null==a)return 0;if("number"==typeof a)return Number.isFinite(a)?a:0;const o=String(a).trim().replace(/\s/g,"").replace(/^R\$/i,"").replace(/\./g,"").replace(/,/g,".").replace(/[^\d.-]/g,""),r=Number(o);return Number.isFinite(r)?r:0}rowId(a){return String(a?.id??a?.Id??a?.extratoId??a?.codigo??a?.identificador??"")}isSavingRow(a){return this.savingRowIds.has(this.rowKey(a))}back(){this.router.navigateByUrl("/extrato-bancario")}clearFilters(){const a=new Date(this.month+"-01T00:00:00");this.dateFrom=a.toISOString().substring(0,10);const e=new Date(a.getFullYear(),a.getMonth()+1,0);this.dateTo=e.toISOString().substring(0,10),this.tipoLancamentoFilter="",this.categoriaFilter="",this.descricaoFilter="",this.pessoaFilter="",this.minValue="",this.maxValue="",this.tableFilters={data:"",tipo:"",categoriaId:"",descricao:"",tipoMovimentacaoId:"",pessoa:"",minValor:"",maxValor:"",fatura:""}}openAddModal(){this.manualData=(0,h.vh)(),this.manualValor="",this.manualTipoLancamento="Entrada",this.manualDescricao="",this.manualPessoa="",this.manualIdentificador="",this.manualCategoriaId="",this.manualObservacao="",this.manualParcelado=!1,this.manualQuantidadeParcelas=2,this.manualGerarTodasParcelas=!0,this.manualNumeroFatura="",this.showAddModal=!0}closeAddModal(){this.saving||(this.showAddModal=!1)}handleSaveManual(){var a=this;return(0,g.A)(function*(){if(a.manualData)if(""!==a.manualValor){a.saving=!0;try{const e={DataMovimentacao:a.manualData,Valor:a.manualValor,TipoLancamento:a.manualTipoLancamento,Descricao:a.manualDescricao||null,NomePessoaTransacao:a.manualPessoa||null,Identificador:a.manualIdentificador||null,BancoId:a.bancoId,TipoCartaoId:a.tipoContaId,CategoriaId:a.manualCategoriaId?Number(a.manualCategoriaId):null,Observacao:a.manualObservacao||null,NumeroFatura:a.manualNumeroFatura||null,EhParcelado:a.manualParcelado??!1};if(!a.isCreditCard||!a.manualParcelado){const d=yield a.extratoItemService.createExtratoManualItem(e);return a.localItems=[d&&"object"==typeof d?d:{id:`manual-${Date.now()}`,dataMovimentacao:a.manualData,valor:(0,h.Yj)(a.manualValor),tipoLancamento:a.manualTipoLancamento,descricao:a.manualDescricao,nomePessoaTransacao:a.manualPessoa,identificador:a.manualIdentificador,bancoId:a.bancoId,tipoCartaoId:a.tipoContaId,categoriaId:a.manualCategoriaId?Number(a.manualCategoriaId):null,categoriaNome:a.manualCategoriaId?a.categoriaNomePorId.get(String(a.manualCategoriaId))??"\u2014":"\u2014",observacao:a.manualObservacao,bancoNome:a.headerBancoNome,tipoCartaoNome:a.headerTipoContaNome,isManual:!0},...a.localItems],a.rebuildForms(),a.setAlert("success","Lan\xe7amento adicionado com sucesso!"),void(a.showAddModal=!1)}const o=Math.max(2,Number(a.manualQuantidadeParcelas)||2);if(a.manualGerarTodasParcelas){const d=`PARC-${Date.now()}`,c=[];for(let u=1;u<=o;u++){const m=At(a.manualData,u-1),_={...e,DataMovimentacao:m,EhParcelado:!0,ParcelaAtual:u,QuantidadeParcelas:o,GrupoParcelamento:d},f=yield a.extratoItemService.createExtratoManualItem(_);c.push(f&&"object"==typeof f?f:{id:`manual-${d}-${u}`,dataMovimentacao:m,valor:(0,h.Yj)(a.manualValor),tipoLancamento:a.manualTipoLancamento,descricao:a.manualDescricao,nomePessoaTransacao:a.manualPessoa,identificador:a.manualIdentificador,bancoId:a.bancoId,tipoCartaoId:a.tipoContaId,categoriaId:a.manualCategoriaId?Number(a.manualCategoriaId):null,categoriaNome:a.manualCategoriaId?a.categoriaNomePorId.get(String(a.manualCategoriaId))??"\u2014":"\u2014",observacao:a.manualObservacao,parcelaAtual:u,quantidadeParcelas:o,grupoParcelamento:d,numeroFatura:a.manualNumeroFatura||null,bancoNome:a.headerBancoNome,tipoCartaoNome:a.headerTipoContaNome,isManual:!0})}return a.localItems=[...c.reverse(),...a.localItems],a.rebuildForms(),a.setAlert("success",`Parcelamento criado: ${o} parcelas.`),void(a.showAddModal=!1)}const r={...e,Parcelado:!0,ParcelaAtual:1,QuantidadeParcelas:o},s=yield a.extratoItemService.createExtratoManualItem(r);a.localItems=[s&&"object"==typeof s?s:{id:`manual-${Date.now()}`,dataMovimentacao:a.manualData,valor:(0,h.Yj)(a.manualValor),tipoLancamento:a.manualTipoLancamento,descricao:a.manualDescricao,nomePessoaTransacao:a.manualPessoa,identificador:a.manualIdentificador,bancoId:a.bancoId,tipoCartaoId:a.tipoContaId,categoriaId:a.manualCategoriaId?Number(a.manualCategoriaId):null,categoriaNome:a.manualCategoriaId?a.categoriaNomePorId.get(String(a.manualCategoriaId))??"\u2014":"\u2014",observacao:a.manualObservacao,ehParcelado:!0,parcelaAtual:1,quantidadeParcelas:o,numeroFatura:a.manualNumeroFatura||null,bancoNome:a.headerBancoNome,tipoCartaoNome:a.headerTipoContaNome,isManual:!0},...a.localItems],a.rebuildForms(),a.setAlert("success",`Compra parcelada registrada (1/${o}).`),a.showAddModal=!1}catch(e){a.setAlert("error",e?.error?.message||e?.message||"Falha ao salvar lan\xe7amento manual.")}finally{a.saving=!1}}else a.setAlert("error","Informe um valor v\xe1lido.");else a.setAlert("error","Informe a data da movimenta\xe7\xe3o.")})()}setAlert(a,e){this.alert={type:a,message:e},setTimeout(()=>this.alert={type:"",message:""},4e3)}money(a){return C(a)}dateBR(a){return function Yt(n){if(!n)return"\u2014";const i=new Date(n);return isNaN(i.getTime())?String(n):i.toLocaleDateString("pt-BR")}(a)}static{this.\u0275fac=function(e){return new(e||n)(t.rXU(F.nX),t.rXU(F.Ix),t.rXU(E.M),t.rXU(k.g),t.rXU(M),t.rXU(l.ok),t.rXU(x.V))}}static{this.\u0275cmp=t.VBU({type:n,selectors:[["app-extrato-bancario-detalhes"]],decls:137,vars:34,consts:[[1,"page-wrapper"],[1,"page-body"],[1,"container-xl"],["class","alert",3,"alert-success","alert-danger","alert-warning",4,"ngIf"],[1,"d-flex","align-items-center","justify-content-between","mb-3"],[1,"text-muted","small"],[1,"m-0"],["class","text-muted",4,"ngIf"],[1,"d-flex","gap-2"],[1,"btn","btn-outline-secondary",3,"click"],[1,"btn","btn-outline-primary",3,"click"],[1,"btn","btn-primary",3,"click"],[1,"card","shadow-sm","mb-3"],[1,"card-body"],[1,"row","g-3","align-items-end"],[1,"col-12","col-md-3"],[1,"form-label","text-muted","mb-1"],["type","date",1,"form-control",3,"ngModel","ngModelChange"],[1,"col-12","col-md-2"],[1,"form-select",3,"ngModel","ngModelChange"],[3,"ngValue"],[3,"ngValue",4,"ngFor","ngForOf"],[1,"col-12","col-md-4"],["type","text","placeholder","Busca tamb\xe9m na observa\xe7\xe3o manual",1,"form-control",3,"ngModel"],["type","text","placeholder","Ex.: Jo\xe3o",1,"form-control",3,"ngModel"],["type","number","step","0.01",1,"form-control","text-end",3,"ngModel"],[1,"col-12","col-md-2","d-flex","gap-2"],[1,"btn","btn-outline-secondary","w-100",3,"click"],[1,"btn","btn-outline-primary","w-100",3,"click"],[1,"d-flex","flex-wrap","gap-3","justify-content-end"],[1,"text-muted"],[1,"text-success"],[1,"text-danger"],[1,"text-primary"],[1,"card","shadow-sm","border-0"],[1,"table-responsive"],[1,"table","table-hover","align-middle","mb-0"],[1,"bg-body-tertiary"],[1,"border-bottom"],[4,"ngIf"],[1,"text-end"],[1,"text-center",2,"width","140px"],["type","date",1,"form-control","form-control-sm",3,"ngModel","ngModelChange"],["placeholder","Tipo...",1,"form-control","form-control-sm",3,"ngModel","ngModelChange"],[1,"form-select","form-select-sm",3,"ngModel","ngModelChange"],["value",""],[3,"value",4,"ngFor","ngForOf"],["placeholder","Descri\xe7\xe3o...",1,"form-control","form-control-sm",3,"ngModel","ngModelChange"],["placeholder","Pessoa...",1,"form-control","form-control-sm",3,"ngModel","ngModelChange"],["placeholder","Min",1,"form-control","form-control-sm","text-end",3,"ngModel","ngModelChange"],["placeholder","Max",1,"form-control","form-control-sm","text-end",3,"ngModel","ngModelChange"],[1,"text-center"],[1,"btn","btn-sm","btn-outline-secondary",3,"click"],[4,"ngFor","ngForOf","ngForTrackBy"],[3,"closed",4,"ngIf"],[1,"alert"],["placeholder","Fatura...",1,"form-control","form-control-sm",3,"ngModel","ngModelChange"],[3,"value"],[1,"text-center","text-primary","py-4","fw-medium"],[1,"spinner-border","spinner-border-sm","me-2"],[1,"text-center","text-secondary","py-4"],[4,"ngIf","ngIfElse"],["editRow",""],[1,"text-end","fw-bold"],[1,"d-inline-flex","gap-2"],[1,"btn","btn-sm","btn-outline-primary",3,"click"],["semParcela",""],[3,"formGroup",4,"ngIf"],[3,"formGroup"],["type","date","formControlName","dataMovimentacao",1,"form-control","form-control-sm"],["formControlName","tipoLancamento",1,"form-select","form-select-sm"],["formControlName","categoriaId",1,"form-select","form-select-sm"],["formControlName","descricao",1,"form-control","form-control-sm"],["formControlName","tipoMovimentacaoId",1,"form-select","form-select-sm"],["formControlName","nomePessoaTransacao",1,"form-control","form-control-sm"],["formControlName","valor",1,"form-control","form-control-sm","text-end"],[1,"btn","btn-sm","btn-primary",3,"disabled","click"],[1,"btn","btn-sm","btn-outline-secondary",3,"disabled","click"],[1,"d-flex","gap-1"],["formControlName","parcelaAtual",1,"form-control","form-control-sm",2,"width","70px"],["formControlName","quantidadeParcelas",1,"form-control","form-control-sm",2,"width","70px"],["formControlName","numeroFatura",1,"form-control","form-control-sm"],["tabindex","-1","role","dialog",1,"modal","show","d-block"],["role","document",1,"modal-dialog","modal-lg",2,"margin-top","100px"],[1,"modal-content"],[1,"modal-header"],[1,"modal-title"],["type","button",1,"btn-close",3,"disabled","click"],[1,"modal-body"],[1,"row","g-3"],[1,"form-label"],["type","date",1,"form-control",3,"ngModel","disabled","ngModelChange"],[1,"form-select",3,"ngModel","disabled","ngModelChange"],["value","Entrada"],["value","Sa\xedda"],["type","text","inputmode","decimal","appMoneyMaskBR","",1,"form-control",3,"ngModel","ngModelChange"],[1,"col-12","col-md-6"],["type","text",1,"form-control",3,"ngModel","disabled","ngModelChange"],[1,"col-12"],["rows","3",1,"form-control",3,"ngModel","disabled","ngModelChange"],["type","text",1,"form-control",3,"disabled","ngModel"],[1,"modal-footer"],[1,"btn","btn-secondary",3,"disabled","click"],[1,"btn","btn-primary",3,"disabled","click"],[1,"modal-backdrop","fade","show"],["type","text","placeholder","Ex.: 2026-01",1,"form-control",3,"disabled","ngModel"],[1,"col-12","col-md-4","d-flex","align-items-end"],[1,"form-check"],["type","checkbox","id","parceladoCheck",1,"form-check-input",3,"ngModel","disabled","ngModelChange"],["for","parceladoCheck",1,"form-check-label"],["type","number","min","2",1,"form-control",3,"ngModel","disabled","ngModelChange"],[1,"col-12","col-md-6","d-flex","align-items-end"],["type","checkbox","id","gerarParcelasCheck",1,"form-check-input",3,"disabled","ngModel"],["for","gerarParcelasCheck",1,"form-check-label"],[3,"closed"]],template:function(e,o){1&e&&(t.j41(0,"div",0)(1,"div",1)(2,"div",2),t.DNE(3,pt,2,7,"div",3),t.j41(4,"div",4)(5,"div")(6,"div",5),t.EFF(7,"Financeiro"),t.k0s(),t.j41(8,"h3",6),t.EFF(9),t.DNE(10,gt,2,0,"span",7),t.k0s()(),t.j41(11,"div",8)(12,"button",9),t.bIt("click",function(){return o.back()}),t.EFF(13,"Voltar"),t.k0s(),t.j41(14,"button",10),t.bIt("click",function(){return o.abrirConfigPessoas()}),t.EFF(15," Configurar pessoas "),t.k0s(),t.j41(16,"button",11),t.bIt("click",function(){return o.openAddModal()}),t.EFF(17,"Adicionar lan\xe7amento"),t.k0s()()(),t.j41(18,"div",12)(19,"div",13)(20,"div",14)(21,"div",15)(22,"label",16),t.EFF(23,"Data (de)"),t.k0s(),t.j41(24,"input",17),t.bIt("ngModelChange",function(s){return o.dateFrom=s}),t.k0s()(),t.j41(25,"div",15)(26,"label",16),t.EFF(27,"Data (at\xe9)"),t.k0s(),t.j41(28,"input",17),t.bIt("ngModelChange",function(s){return o.dateTo=s}),t.k0s()(),t.j41(29,"div",18)(30,"label",16),t.EFF(31,"Tipo lan\xe7amento"),t.k0s(),t.j41(32,"select",19),t.bIt("ngModelChange",function(s){return o.tipoLancamentoFilter=s}),t.j41(33,"option",20),t.EFF(34,"Todos"),t.k0s(),t.DNE(35,_t,2,2,"option",21),t.k0s()(),t.j41(36,"div",22)(37,"label",16),t.EFF(38,"Categoria"),t.k0s(),t.j41(39,"select",19),t.bIt("ngModelChange",function(s){return o.categoriaFilter=s}),t.j41(40,"option",20),t.EFF(41,"Todas"),t.k0s(),t.DNE(42,ft,2,2,"option",21),t.k0s()(),t.j41(43,"div",22)(44,"label",16),t.EFF(45,"Descri\xe7\xe3o / Observa\xe7\xe3o"),t.k0s(),t.j41(46,"input",23),t.bIt("ngModel",function(){return o.descricaoFilter}),t.k0s()(),t.j41(47,"div",22)(48,"label",16),t.EFF(49,"Pessoa transa\xe7\xe3o"),t.k0s(),t.j41(50,"input",24),t.bIt("ngModel",function(){return o.pessoaFilter}),t.k0s()(),t.j41(51,"div",18)(52,"label",16),t.EFF(53,"Valor m\xednimo"),t.k0s(),t.j41(54,"input",25),t.bIt("ngModel",function(){return o.minValue}),t.k0s()(),t.j41(55,"div",18)(56,"label",16),t.EFF(57,"Valor m\xe1ximo"),t.k0s(),t.j41(58,"input",25),t.bIt("ngModel",function(){return o.maxValue}),t.k0s()(),t.j41(59,"div",26)(60,"button",27),t.bIt("click",function(){return o.clearFilters()}),t.EFF(61,"Limpar"),t.k0s(),t.j41(62,"button",28),t.bIt("click",function(){return o.refresh()}),t.EFF(63,"Atualizar"),t.k0s()()(),t.nrm(64,"hr"),t.j41(65,"div",29)(66,"div",30),t.EFF(67,"Itens: "),t.j41(68,"strong"),t.EFF(69),t.k0s()(),t.j41(70,"div",31),t.EFF(71,"Entrada: "),t.j41(72,"strong"),t.EFF(73),t.k0s()(),t.j41(74,"div",32),t.EFF(75,"Sa\xedda: "),t.j41(76,"strong"),t.EFF(77),t.k0s()(),t.j41(78,"div",33),t.EFF(79,"Total: "),t.j41(80,"strong"),t.EFF(81),t.k0s()()()()(),t.j41(82,"div",34)(83,"div",35)(84,"table",36)(85,"thead",37)(86,"tr",38)(87,"th"),t.EFF(88,"Data"),t.k0s(),t.j41(89,"th"),t.EFF(90,"Tipo"),t.k0s(),t.DNE(91,ht,5,0,"ng-container",39),t.j41(92,"th"),t.EFF(93,"Categoria"),t.k0s(),t.j41(94,"th"),t.EFF(95,"Descri\xe7\xe3o"),t.k0s(),t.j41(96,"th"),t.EFF(97,"Tipo Mov."),t.k0s(),t.j41(98,"th"),t.EFF(99,"Pessoa"),t.k0s(),t.j41(100,"th",40),t.EFF(101,"Valor"),t.k0s(),t.j41(102,"th",41),t.EFF(103,"A\xe7\xf5es"),t.k0s()(),t.j41(104,"tr")(105,"th")(106,"input",42),t.bIt("ngModelChange",function(s){return o.tableFilters.data=s}),t.k0s()(),t.j41(107,"th")(108,"input",43),t.bIt("ngModelChange",function(s){return o.tableFilters.tipo=s}),t.k0s()(),t.DNE(109,bt,4,1,"ng-container",39),t.j41(110,"th")(111,"select",44),t.bIt("ngModelChange",function(s){return o.tableFilters.categoriaId=s}),t.j41(112,"option",45),t.EFF(113,"Todas"),t.k0s(),t.DNE(114,Ft,2,2,"option",46),t.k0s()(),t.j41(115,"th")(116,"input",47),t.bIt("ngModelChange",function(s){return o.tableFilters.descricao=s}),t.k0s()(),t.j41(117,"th")(118,"select",44),t.bIt("ngModelChange",function(s){return o.tableFilters.tipoMovimentacaoId=s}),t.j41(119,"option",45),t.EFF(120,"Todos"),t.k0s(),t.DNE(121,vt,2,2,"option",46),t.k0s()(),t.j41(122,"th")(123,"input",48),t.bIt("ngModelChange",function(s){return o.tableFilters.pessoa=s}),t.k0s()(),t.j41(124,"th")(125,"div",8)(126,"input",49),t.bIt("ngModelChange",function(s){return o.tableFilters.minValor=s}),t.k0s(),t.j41(127,"input",50),t.bIt("ngModelChange",function(s){return o.tableFilters.maxValor=s}),t.k0s()()(),t.j41(128,"th",51)(129,"button",52),t.bIt("click",function(){return o.clearFilters()}),t.EFF(130,"Limpar"),t.k0s()()()(),t.j41(131,"tbody"),t.DNE(132,Et,4,1,"tr",39),t.DNE(133,Ct,3,1,"tr",39),t.DNE(134,Nt,4,2,"tr",53),t.k0s()()()(),t.DNE(135,Vt,57,21,"ng-container",39),t.k0s()(),t.DNE(136,Pt,1,0,"app-modal-configuracao-vinculo-pessoa",54),t.k0s()),2&e&&(t.R7$(3),t.Y8G("ngIf",o.alert.message),t.R7$(6),t.Lme(" Detalhes \u2014 ",o.headerBancoNome," / ",o.headerTipoContaNome," "),t.R7$(1),t.Y8G("ngIf",o.isCreditCard),t.R7$(14),t.Y8G("ngModel",o.dateFrom),t.R7$(4),t.Y8G("ngModel",o.dateTo),t.R7$(4),t.Y8G("ngModel",o.tipoLancamentoFilter),t.R7$(1),t.Y8G("ngValue",""),t.R7$(2),t.Y8G("ngForOf",o.tipoLancamentoOptions),t.R7$(4),t.Y8G("ngModel",o.categoriaFilter),t.R7$(1),t.Y8G("ngValue",""),t.R7$(2),t.Y8G("ngForOf",o.categorias),t.R7$(27),t.JRh(o.totalItens),t.R7$(4),t.JRh(o.money(o.totalEntrada)),t.R7$(4),t.JRh(o.money(o.totalSaida)),t.R7$(4),t.JRh(o.money(o.totalValor)),t.R7$(10),t.Y8G("ngIf",o.isCreditCard),t.R7$(15),t.Y8G("ngModel",o.tableFilters.data),t.R7$(2),t.Y8G("ngModel",o.tableFilters.tipo),t.R7$(1),t.Y8G("ngIf",o.isCreditCard),t.R7$(2),t.Y8G("ngModel",o.tableFilters.categoriaId),t.R7$(3),t.Y8G("ngForOf",o.categorias),t.R7$(2),t.Y8G("ngModel",o.tableFilters.descricao),t.R7$(2),t.Y8G("ngModel",o.tableFilters.tipoMovimentacaoId),t.R7$(3),t.Y8G("ngForOf",o.tiposMovimentacao),t.R7$(2),t.Y8G("ngModel",o.tableFilters.pessoa),t.R7$(3),t.Y8G("ngModel",o.tableFilters.minValor),t.R7$(1),t.Y8G("ngModel",o.tableFilters.maxValor),t.R7$(5),t.Y8G("ngIf",o.loading),t.R7$(1),t.Y8G("ngIf",!o.loading&&0===o.filteredExtratos.length),t.R7$(1),t.Y8G("ngForOf",o.filteredExtratos)("ngForTrackBy",o.trackByRow),t.R7$(1),t.Y8G("ngIf",o.showAddModal),t.R7$(1),t.Y8G("ngIf",o.showModalConfigPessoas))},dependencies:[b.Sq,b.bT,l.xH,l.y7,l.me,l.Q0,l.Zm,l.wz,l.BC,l.cb,l.VZ,l.vS,l.j4,l.JD,j,ut,b.vh],encapsulation:2})}}return n})()}];let Lt=(()=>{class n{static{this.\u0275fac=function(e){return new(e||n)}}static{this.\u0275mod=t.$C({type:n})}static{this.\u0275inj=t.G2t({imports:[F.iI.forChild(Xt),F.iI]})}}return n})();var Ot=p(3887);let Ut=(()=>{class n{static{this.\u0275fac=function(e){return new(e||n)}}static{this.\u0275mod=t.$C({type:n})}static{this.\u0275inj=t.G2t({imports:[Ot.G,Lt]})}}return n})()}}]);