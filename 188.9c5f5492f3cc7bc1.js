"use strict";(self.webpackChunkmy_finance_front=self.webpackChunkmy_finance_front||[]).push([[188],{3188:(C,p,s)=>{s.r(p),s.d(p,{TipoMovimentacaoModule:()=>j});var m=s(177),r=s(4341),u=s(9032),d=s(467),t=s(540),v=s(4772);function f(n,l){1&n&&(t.j41(0,"div",16),t.EFF(1," Informe um nome v\xe1lido. "),t.k0s())}function h(n,l){1&n&&(t.j41(0,"div",16),t.EFF(1," Informe um valor meta. "),t.k0s())}let F=(()=>{class n{constructor(e,o){this.fb=e,this.service=o,this.item=null,this.closed=new t.bkB,this.saving=!1,this.form=this.fb.group({nomeTipoMovimentacao:["",[r.k0.required,r.k0.minLength(2)]],descricao:[""],valorMeta:[0,[r.k0.required]]})}ngOnInit(){this.item&&this.form.patchValue({nomeTipoMovimentacao:this.item.nomeTipoMovimentacao,descricao:this.item.descricao??"",valorMeta:Number(this.item.valorMeta)||0})}close(e=!1){this.closed.emit(e)}save(){var e=this;return(0,d.A)(function*(){if(e.form.invalid)e.form.markAllAsTouched();else try{e.saving=!0;const o={id:e.item?.id,nomeTipoMovimentacao:e.form.value.nomeTipoMovimentacao,descricao:e.form.value.descricao??"",valorMeta:Number(e.form.value.valorMeta)||0};e.item?yield e.service.update(o):yield e.service.create(o),e.close(!0)}catch{alert("Erro ao salvar Tipo de Movimenta\xe7\xe3o.")}finally{e.saving=!1}})()}static{this.\u0275fac=function(o){return new(o||n)(t.rXU(r.ok),t.rXU(v.V))}}static{this.\u0275cmp=t.VBU({type:n,selectors:[["app-tipo-movimentacao-form"]],inputs:{item:"item"},outputs:{closed:"closed"},decls:27,vars:10,consts:[[1,"modal-backdrop-custom",3,"click"],["role","dialog","aria-modal","true",1,"modal-custom"],[1,"modal-card","card"],[1,"card-header"],[1,"card-title","m-0"],["type","button","aria-label","Fechar",1,"btn-close",3,"click"],[1,"card-body",3,"formGroup"],[1,"mb-3"],[1,"form-label"],["formControlName","nomeTipoMovimentacao",1,"form-control"],["class","invalid-feedback",4,"ngIf"],["formControlName","descricao",1,"form-control"],["type","number","formControlName","valorMeta",1,"form-control"],[1,"card-footer","d-flex","justify-content-end","gap-2"],["type","button",1,"btn","btn-outline-secondary",3,"click"],["type","button",1,"btn","btn-primary",3,"disabled","click"],[1,"invalid-feedback"]],template:function(o,i){1&o&&(t.j41(0,"div",0),t.bIt("click",function(){return i.close(!1)}),t.k0s(),t.j41(1,"div",1)(2,"div",2)(3,"div",3)(4,"h3",4),t.EFF(5),t.k0s(),t.j41(6,"button",5),t.bIt("click",function(){return i.close(!1)}),t.k0s()(),t.j41(7,"div",6)(8,"div",7)(9,"label",8),t.EFF(10,"Tipo Movimenta\xe7\xe3o"),t.k0s(),t.nrm(11,"input",9),t.DNE(12,f,2,0,"div",10),t.k0s(),t.j41(13,"div",7)(14,"label",8),t.EFF(15,"Descri\xe7\xe3o"),t.k0s(),t.nrm(16,"input",11),t.k0s(),t.j41(17,"div",7)(18,"label",8),t.EFF(19,"Valor Meta"),t.k0s(),t.nrm(20,"input",12),t.DNE(21,h,2,0,"div",10),t.k0s()(),t.j41(22,"div",13)(23,"button",14),t.bIt("click",function(){return i.close(!1)}),t.EFF(24,"Cancelar"),t.k0s(),t.j41(25,"button",15),t.bIt("click",function(){return i.save()}),t.EFF(26),t.k0s()()()()),2&o&&(t.R7$(5),t.JRh(i.item?"Editar Tipo de Movimenta\xe7\xe3o":"Novo Tipo de Movimenta\xe7\xe3o"),t.R7$(2),t.Y8G("formGroup",i.form),t.R7$(4),t.AVh("is-invalid",i.form.controls.nomeTipoMovimentacao.touched&&i.form.controls.nomeTipoMovimentacao.invalid),t.R7$(1),t.Y8G("ngIf",i.form.controls.nomeTipoMovimentacao.touched&&i.form.controls.nomeTipoMovimentacao.invalid),t.R7$(8),t.AVh("is-invalid",i.form.controls.valorMeta.touched&&i.form.controls.valorMeta.invalid),t.R7$(1),t.Y8G("ngIf",i.form.controls.valorMeta.touched&&i.form.controls.valorMeta.invalid),t.R7$(4),t.Y8G("disabled",i.saving),t.R7$(1),t.SpI(" ",i.saving?"Salvando...":"Salvar"," "))},dependencies:[m.bT,r.me,r.Q0,r.BC,r.cb,r.j4,r.JD],styles:[".modal-backdrop-custom[_ngcontent-%COMP%]{position:fixed;inset:0;background:rgba(0,0,0,.45);z-index:2000}.modal-custom[_ngcontent-%COMP%]{position:fixed;inset:0;display:flex;align-items:center;justify-content:center;padding:16px;z-index:2001}.modal-card[_ngcontent-%COMP%]{width:100%;max-width:820px;border-radius:10px}"]})}}return n})();function b(n,l){if(1&n&&(t.j41(0,"div",36),t.EFF(1),t.k0s()),2&n){const e=t.XpG();t.AVh("alert-success","success"===e.alert.type)("alert-danger","error"===e.alert.type),t.R7$(1),t.SpI(" ",e.alert.message," ")}}function M(n,l){if(1&n){const e=t.RV6();t.j41(0,"tr")(1,"td",37),t.EFF(2),t.k0s(),t.j41(3,"td",38),t.EFF(4),t.k0s(),t.j41(5,"td",37),t.EFF(6),t.k0s(),t.j41(7,"td",39),t.EFF(8),t.k0s(),t.j41(9,"td",40)(10,"div",41)(11,"button",42),t.bIt("click",function(){const a=t.eBV(e).$implicit,c=t.XpG();return t.Njj(c.openEdit(a))}),t.EFF(12," \u270f\ufe0f "),t.k0s(),t.j41(13,"button",43),t.bIt("click",function(){const a=t.eBV(e).$implicit,c=t.XpG();return t.Njj(c.onDelete(a))}),t.EFF(14," \u{1f5d1}\ufe0f "),t.k0s()()()()}if(2&n){const e=l.$implicit,o=t.XpG();t.R7$(2),t.JRh(e.id),t.R7$(2),t.JRh(e.nomeTipoMovimentacao),t.R7$(2),t.JRh(e.descricao),t.R7$(2),t.JRh(o.formatMoney(e.valorMeta))}}function g(n,l){1&n&&(t.j41(0,"tr")(1,"td",44),t.EFF(2," Nenhum tipo de movimenta\xe7\xe3o encontrado. "),t.k0s()())}function T(n,l){1&n&&(t.j41(0,"tr")(1,"td",44),t.EFF(2,"Carregando..."),t.k0s()())}function _(n,l){if(1&n&&(t.j41(0,"tr")(1,"td",45),t.EFF(2),t.k0s()()),2&n){const e=t.XpG();t.R7$(2),t.JRh(e.errorMsg)}}function k(n,l){if(1&n){const e=t.RV6();t.j41(0,"app-tipo-movimentacao-form",46),t.bIt("closed",function(i){t.eBV(e);const a=t.XpG();return t.Njj(a.closeForm(i))}),t.k0s()}if(2&n){const e=t.XpG();t.Y8G("item",e.editing)}}const E=[{path:"",component:(()=>{class n{constructor(e){this.service=e,this.items=[],this.filtered=[],this.loading=!1,this.errorMsg="",this.q="",this.showModalForm=!1,this.editing=null,this.alert={type:"",message:""}}ngOnInit(){var e=this;return(0,d.A)(function*(){yield e.load()})()}load(){var e=this;return(0,d.A)(function*(){try{e.loading=!0,e.errorMsg="",e.items=(yield e.service.list())??[],e.applyFilters()}catch(o){e.errorMsg=o?.message??"Erro ao carregar Tipos de Movimenta\xe7\xe3o."}finally{e.loading=!1}})()}applyFilters(){const e=this.q.trim().toLowerCase();this.filtered=[...this.items].sort((o,i)=>(o.nomeTipoMovimentacao??"").localeCompare(i.nomeTipoMovimentacao??"")).filter(o=>!e||(o.nomeTipoMovimentacao??"").toLowerCase().includes(e)||String(o.id).includes(e))}onSearchChange(e){this.q=e,this.applyFilters()}get totalMetas(){return this.filtered.reduce((e,o)=>e+(Number(o.valorMeta)||0),0)}formatMoney(e){const o=Number(e)||0;return new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(o)}openCreate(){this.editing=null,this.showModalForm=!0}openEdit(e){this.editing=e,this.showModalForm=!0}closeForm(e){this.showModalForm=!1,this.editing=null,e&&this.load()}onDelete(e){var o=this;return(0,d.A)(function*(){if(window.confirm(`Excluir o tipo de movimenta\xe7\xe3o "${e.nomeTipoMovimentacao}"?`))try{yield o.service.delete(e.id),o.alert={type:"success",message:"Tipo de Movimenta\xe7\xe3o deletado com sucesso!"},setTimeout(()=>o.alert={type:"",message:""},3e3),yield o.load()}catch{o.alert={type:"error",message:"Falha ao deletar. O tipo de Movimenta\xe7\xe3o pode estar vinculado a transa\xe7\xf5es."},setTimeout(()=>o.alert={type:"",message:""},12e3)}})()}static{this.\u0275fac=function(o){return new(o||n)(t.rXU(v.V))}}static{this.\u0275cmp=t.VBU({type:n,selectors:[["app-tipo-movimentacao-list"]],decls:56,vars:11,consts:[[1,"container-xl","py-3"],["class","alert",3,"alert-success","alert-danger",4,"ngIf"],[1,"page-header","d-print-none","mb-3"],[1,"row","align-items-center"],[1,"col"],[1,"page-pretitle"],[1,"page-title"],[1,"col-auto","ms-auto","d-print-none"],[1,"btn-list"],["type","button",1,"btn","btn-outline-secondary",3,"click"],["type","button",1,"btn","btn-primary",3,"click"],[1,"card","mb-3"],[1,"card-body"],[1,"row","g-2","align-items-end"],[1,"col-12","col-lg-5"],[1,"form-label","mb-1"],["placeholder","Nome ou ID",1,"form-control",3,"value","input"],[1,"col-12","col-lg-3"],[1,"col-12","col-lg-4","text-end"],[1,"d-flex","flex-column","align-items-end"],[1,"text-muted","small"],[1,"fw-bold","fs-5","text-primary"],[1,"card-footer","py-2"],[1,"d-flex","justify-content-between","align-items-center"],[1,"badge","bg-secondary-lt"],[1,"card","shadow-sm"],[1,"table-responsive"],[1,"table","card-table","table-vcenter","table-hover"],[1,"bg-body-tertiary"],[1,"w-1","text-muted"],[1,"text-nowrap"],[1,"text-nowrap","text-end"],[1,"w-1","text-center"],[4,"ngFor","ngForOf"],[4,"ngIf"],[3,"item","closed",4,"ngIf"],[1,"alert"],[1,"text-muted"],[1,"fw-bold"],[1,"fw-medium","text-end"],[1,"text-center"],[1,"d-flex"],["type","button","title","Editar",1,"btn","btn-icon","btn-soft-secondary",3,"click"],["type","button","title","Excluir",1,"btn","btn-icon","btn-soft-danger",3,"click"],["colspan","5",1,"text-center","text-secondary","py-4"],["colspan","5",1,"text-center","text-danger","py-4"],[3,"item","closed"]],template:function(o,i){1&o&&(t.j41(0,"div",0),t.DNE(1,b,2,5,"div",1),t.j41(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5),t.EFF(6,"Cadastros"),t.k0s(),t.j41(7,"h2",6),t.EFF(8,"Tipos de Movimenta\xe7\xe3o"),t.k0s()(),t.j41(9,"div",7)(10,"div",8)(11,"button",9),t.bIt("click",function(){return i.load()}),t.EFF(12,"Atualizar"),t.k0s(),t.j41(13,"button",10),t.bIt("click",function(){return i.openCreate()}),t.EFF(14,"+ Novo Tipo de Movimenta\xe7\xe3o"),t.k0s()()()()(),t.j41(15,"div",11)(16,"div",12)(17,"div",13)(18,"div",14)(19,"label",15),t.EFF(20,"Buscar"),t.k0s(),t.j41(21,"input",16),t.bIt("input",function(c){return i.onSearchChange(c.target.value)}),t.k0s()(),t.nrm(22,"div",17),t.j41(23,"div",18)(24,"div",19)(25,"span",20),t.EFF(26,"Soma Total das Metas"),t.k0s(),t.j41(27,"span",21),t.EFF(28),t.k0s()()()()(),t.j41(29,"div",22)(30,"div",23)(31,"span",20),t.EFF(32),t.k0s(),t.j41(33,"span",24),t.EFF(34),t.k0s()()()(),t.j41(35,"div",25)(36,"div",26)(37,"table",27)(38,"thead",28)(39,"tr")(40,"th",29),t.EFF(41,"ID"),t.k0s(),t.j41(42,"th",30),t.EFF(43,"Tipo Movimenta\xe7\xe3o"),t.k0s(),t.j41(44,"th",30),t.EFF(45,"Descri\xe7\xe3o"),t.k0s(),t.j41(46,"th",31),t.EFF(47,"Valor Meta"),t.k0s(),t.j41(48,"th",32),t.EFF(49,"A\xe7\xf5es"),t.k0s()()(),t.j41(50,"tbody"),t.DNE(51,M,15,4,"tr",33),t.DNE(52,g,3,0,"tr",34),t.DNE(53,T,3,0,"tr",34),t.DNE(54,_,3,1,"tr",34),t.k0s()()()(),t.DNE(55,k,1,1,"app-tipo-movimentacao-form",35),t.k0s()),2&o&&(t.R7$(1),t.Y8G("ngIf",i.alert.message),t.R7$(20),t.Y8G("value",i.q),t.R7$(7),t.JRh(i.formatMoney(i.totalMetas)),t.R7$(4),t.Lme(" Mostrando ",i.filtered.length," ",1===i.filtered.length?"tipo de movimenta\xe7\xe3o":"tipos de movimenta\xe7\xe3o"," "),t.R7$(2),t.SpI(" Total de Registros: ",i.items.length," "),t.R7$(17),t.Y8G("ngForOf",i.filtered),t.R7$(1),t.Y8G("ngIf",!i.loading&&0===i.filtered.length),t.R7$(1),t.Y8G("ngIf",i.loading),t.R7$(1),t.Y8G("ngIf",i.errorMsg),t.R7$(1),t.Y8G("ngIf",i.showModalForm))},dependencies:[m.Sq,m.bT,F]})}}return n})()}];let y=(()=>{class n{static{this.\u0275fac=function(o){return new(o||n)}}static{this.\u0275mod=t.$C({type:n})}static{this.\u0275inj=t.G2t({imports:[u.iI.forChild(E),u.iI]})}}return n})(),j=(()=>{class n{static{this.\u0275fac=function(o){return new(o||n)}}static{this.\u0275mod=t.$C({type:n})}static{this.\u0275inj=t.G2t({imports:[m.MD,r.X1,y]})}}return n})()}}]);