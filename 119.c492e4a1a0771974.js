"use strict";(self.webpackChunkmy_finance_front=self.webpackChunkmy_finance_front||[]).push([[119],{9119:(I,m,s)=>{s.r(m),s.d(m,{CategoriaModule:()=>j});var d=s(177),i=s(4341),g=s(9032),u=s(467),t=s(540),p=s(7008);function f(o,c){1&o&&(t.j41(0,"div",17),t.EFF(1," Informe um nome v\xe1lido. "),t.k0s())}let h=(()=>{class o{constructor(e,a){this.fb=e,this.categoryService=a,this.category=null,this.closed=new t.bkB,this.saving=!1,this.form=this.fb.group({name:["",[i.k0.required,i.k0.minLength(2)]],subCategory:["",[i.k0.required,i.k0.required]]})}ngOnInit(){this.category&&this.form.patchValue({name:this.category.name,subCategory:this.category.subCategory})}close(e=!1){this.closed.emit(e)}save(){var e=this;return(0,u.A)(function*(){if(e.form.invalid)e.form.markAllAsTouched();else try{e.saving=!0;const a={name:e.form.value.name,subCategory:e.form.value.subCategory};e.category?yield e.categoryService.update(e.category.id,a):yield e.categoryService.create(a),e.close(!0)}catch{alert("Erro ao salvar categoria.")}finally{e.saving=!1}})()}static{this.\u0275fac=function(a){return new(a||o)(t.rXU(i.ok),t.rXU(p.M))}}static{this.\u0275cmp=t.VBU({type:o,selectors:[["app-categoria-form"]],inputs:{category:"category"},outputs:{closed:"closed"},decls:26,vars:7,consts:[[1,"modal-backdrop-custom",3,"click"],["role","dialog","aria-modal","true",1,"modal-custom"],[1,"modal-card","card"],[1,"card-header"],[1,"card-title","m-0"],["type","button","aria-label","Fechar",1,"btn-close",3,"click"],[1,"card-body",3,"formGroup"],[1,"mb-3"],[1,"form-label"],["type","text","formControlName","name",1,"form-control"],["class","invalid-feedback",4,"ngIf"],["formControlName","subCategory",1,"form-select"],["value","Receita"],["value","Despesa"],[1,"card-footer","d-flex","justify-content-end","gap-2"],["type","button",1,"btn","btn-outline-secondary",3,"click"],["type","button",1,"btn","btn-primary",3,"disabled","click"],[1,"invalid-feedback"]],template:function(a,r){1&a&&(t.j41(0,"div",0),t.bIt("click",function(){return r.close(!1)}),t.k0s(),t.j41(1,"div",1)(2,"div",2)(3,"div",3)(4,"h3",4),t.EFF(5),t.k0s(),t.j41(6,"button",5),t.bIt("click",function(){return r.close(!1)}),t.k0s()(),t.j41(7,"div",6)(8,"div",7)(9,"label",8),t.EFF(10,"Nome"),t.k0s(),t.nrm(11,"input",9),t.DNE(12,f,2,0,"div",10),t.k0s(),t.j41(13,"div",7)(14,"label",8),t.EFF(15,"Sub Categoria"),t.k0s(),t.j41(16,"select",11)(17,"option",12),t.EFF(18,"Receita"),t.k0s(),t.j41(19,"option",13),t.EFF(20,"Despesa"),t.k0s()()()(),t.j41(21,"div",14)(22,"button",15),t.bIt("click",function(){return r.close(!1)}),t.EFF(23," Cancelar "),t.k0s(),t.j41(24,"button",16),t.bIt("click",function(){return r.save()}),t.EFF(25),t.k0s()()()()),2&a&&(t.R7$(5),t.JRh(r.category?"Editar Categoria":"Nova Categoria"),t.R7$(2),t.Y8G("formGroup",r.form),t.R7$(4),t.AVh("is-invalid",r.form.controls.name.touched&&r.form.controls.name.invalid),t.R7$(1),t.Y8G("ngIf",r.form.controls.name.touched&&r.form.controls.name.invalid),t.R7$(12),t.Y8G("disabled",r.saving),t.R7$(1),t.SpI(" ",r.saving?"Salvando...":"Salvar"," "))},dependencies:[d.bT,i.xH,i.y7,i.me,i.wz,i.BC,i.cb,i.j4,i.JD],styles:[".modal-backdrop-custom[_ngcontent-%COMP%]{position:fixed;inset:0;background:rgba(0,0,0,.45);z-index:3000}.modal-custom[_ngcontent-%COMP%]{position:fixed;inset:0;display:grid;place-items:center;z-index:3001;padding:16px}.modal-card[_ngcontent-%COMP%]{width:100%;max-width:520px}"]})}}return o})();function F(o,c){if(1&o&&(t.j41(0,"div",34),t.EFF(1),t.k0s()),2&o){const e=t.XpG();t.AVh("alert-success","success"===e.alert.type)("alert-danger","error"===e.alert.type),t.R7$(1),t.SpI(" ",e.alert.message," ")}}function C(o,c){if(1&o){const e=t.RV6();t.j41(0,"tr")(1,"td",35),t.EFF(2),t.k0s(),t.j41(3,"td",36),t.EFF(4),t.k0s(),t.j41(5,"td")(6,"span",37),t.EFF(7),t.k0s()(),t.j41(8,"td",38)(9,"div",39)(10,"button",40),t.bIt("click",function(){const n=t.eBV(e).$implicit,l=t.XpG();return t.Njj(l.onEdit(n))}),t.EFF(11," \u270f\ufe0f "),t.k0s(),t.j41(12,"button",41),t.bIt("click",function(){const n=t.eBV(e).$implicit,l=t.XpG();return t.Njj(l.onDelete(n))}),t.EFF(13," \u{1f5d1}\ufe0f "),t.k0s()()()()}if(2&o){const e=c.$implicit;t.R7$(2),t.JRh(e.id),t.R7$(2),t.JRh(e.name),t.R7$(2),t.Y8G("ngClass","receita"===(e.subCategory||"").trim().toLowerCase()?"text-success":"text-danger"),t.R7$(1),t.SpI(" ",e.subCategory,"")}}function b(o,c){1&o&&(t.j41(0,"tr")(1,"td",42),t.EFF(2," Nenhuma categoria encontrada. "),t.k0s()())}function v(o,c){1&o&&(t.j41(0,"tr")(1,"td",42),t.EFF(2," Carregando... "),t.k0s()())}function y(o,c){if(1&o&&(t.j41(0,"tr")(1,"td",43),t.EFF(2),t.k0s()()),2&o){const e=t.XpG();t.R7$(2),t.SpI(" ",e.errorMsg," ")}}function _(o,c){if(1&o){const e=t.RV6();t.j41(0,"app-categoria-form",44),t.bIt("closed",function(r){t.eBV(e);const n=t.XpG();return t.Njj(n.closeForm(r))}),t.k0s()}if(2&o){const e=t.XpG();t.Y8G("category",e.editing)}}const k=[{path:"",component:(()=>{class o{constructor(e){this.categoryService=e,this.categorias=[],this.categoria=[],this.loading=!1,this.errorMsg="",this.q="",this.statusFilter="ALL",this.showModalForm=!1,this.editing=null,this.alert={type:"",message:""}}ngOnInit(){var e=this;return(0,u.A)(function*(){yield e.load()})()}load(){var e=this;return(0,u.A)(function*(){try{e.loading=!0,e.errorMsg="",e.categorias=yield e.categoryService.list(),e.applyFilters()}catch(a){e.errorMsg=a?.message??"Erro ao carregar categorias."}finally{e.loading=!1}})()}applyFilters(){const e=this.q.trim().toLowerCase();this.categoria=[...this.categorias].sort((a,r)=>(a.name??"").localeCompare(r.name??"")).filter(a=>!e||(a.name??"").toLowerCase().includes(e)||String(a.id).includes(e))}onSearchChange(e){this.q=e,this.applyFilters()}onStatusChange(e){this.statusFilter=e,this.applyFilters()}badgeClass(e){return"Ativo"===e?"badge bg-success":"Inativo"===e?"badge bg-secondary":"badge bg-muted"}openCreate(){this.editing=null,this.showModalForm=!0}onEdit(e){this.editing=e,this.showModalForm=!0}closeForm(e){this.showModalForm=!1,this.editing=null,e&&this.load()}onDelete(e){var a=this;return(0,u.A)(function*(){if(window.confirm(`Excluir a categoria "${e.name}"?`))try{yield a.categoryService.delete(e.id),a.alert={type:"success",message:"Categoria deletada com sucesso!"},setTimeout(()=>a.alert={type:"",message:""},3e3),yield a.load()}catch{a.alert={type:"error",message:"Falha ao deletar. Categoria pode estar vinculada a transa\xe7\xf5es."},setTimeout(()=>a.alert={type:"",message:""},12e3)}})()}static{this.\u0275fac=function(a){return new(a||o)(t.rXU(p.M))}}static{this.\u0275cmp=t.VBU({type:o,selectors:[["app-categoria-list"]],decls:54,vars:10,consts:[[1,"container-xl","py-3"],["class","alert",3,"alert-success","alert-danger",4,"ngIf"],[1,"page-header","d-print-none","mb-3"],[1,"row","align-items-center"],[1,"col"],[1,"page-pretitle"],[1,"page-title"],[1,"col-auto","ms-auto","d-print-none"],[1,"btn-list"],["type","button",1,"btn","btn-outline-secondary",3,"click"],["type","button",1,"btn","btn-primary",3,"click"],[1,"card","mb-3"],[1,"card-body"],[1,"row","g-2","align-items-end"],[1,"col-12","col-md-6"],[1,"form-label"],["type","text","placeholder","Nome ou ID",1,"form-control",3,"value","input"],[1,"col-12","col-md-3"],[1,"form-select",3,"value","change"],["value","ALL"],["value","Ativo"],["value","Inativo"],[1,"col-12","col-md-3","d-flex","justify-content-md-end"],[1,"text-muted","small","mt-3","mt-md-0"],[1,"card"],[1,"table-responsive"],[1,"table","card-table","table-vcenter","table-hover"],[1,"bg-body-tertiary"],[1,"w-1"],[1,"text-nowrap"],[1,"w-1","text-center"],[4,"ngFor","ngForOf"],[4,"ngIf"],[3,"category","closed",4,"ngIf"],[1,"alert"],[1,"text-muted"],[1,"fw-medium"],[3,"ngClass"],[1,"text-center"],[1,"d-flex"],["type","button","title","Editar",1,"btn","btn-icon","btn-soft-secondary",3,"click"],["type","button","title","Excluir",1,"btn","btn-icon","btn-soft-danger",3,"click"],["colspan","4",1,"text-center","text-secondary","py-4"],["colspan","4",1,"text-center","text-danger","py-4"],[3,"category","closed"]],template:function(a,r){1&a&&(t.j41(0,"div",0),t.DNE(1,F,2,5,"div",1),t.j41(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5),t.EFF(6,"Cadastros"),t.k0s(),t.j41(7,"h2",6),t.EFF(8,"Categorias"),t.k0s()(),t.j41(9,"div",7)(10,"div",8)(11,"button",9),t.bIt("click",function(){return r.load()}),t.EFF(12," Atualizar "),t.k0s(),t.j41(13,"button",10),t.bIt("click",function(){return r.openCreate()}),t.EFF(14," + Nova categoria "),t.k0s()()()()(),t.j41(15,"div",11)(16,"div",12)(17,"div",13)(18,"div",14)(19,"label",15),t.EFF(20,"Buscar"),t.k0s(),t.j41(21,"input",16),t.bIt("input",function(l){return r.onSearchChange(l.target.value)}),t.k0s()(),t.j41(22,"div",17)(23,"label",15),t.EFF(24,"Status"),t.k0s(),t.j41(25,"select",18),t.bIt("change",function(l){return r.onStatusChange(l.target.value)}),t.j41(26,"option",19),t.EFF(27,"Todos"),t.k0s(),t.j41(28,"option",20),t.EFF(29,"Ativo"),t.k0s(),t.j41(30,"option",21),t.EFF(31,"Inativo"),t.k0s()()(),t.j41(32,"div",22)(33,"div",23),t.EFF(34),t.k0s()()()()(),t.j41(35,"div",24)(36,"div",25)(37,"table",26)(38,"thead",27)(39,"tr")(40,"th",28),t.EFF(41,"ID"),t.k0s(),t.j41(42,"th"),t.EFF(43,"Nome"),t.k0s(),t.j41(44,"th",29),t.EFF(45,"Sub Categoria"),t.k0s(),t.j41(46,"th",30),t.EFF(47,"A\xe7\xf5es"),t.k0s()()(),t.j41(48,"tbody"),t.DNE(49,C,14,4,"tr",31),t.DNE(50,b,3,0,"tr",32),t.DNE(51,v,3,0,"tr",32),t.DNE(52,y,3,1,"tr",32),t.k0s()()()(),t.DNE(53,_,1,1,"app-categoria-form",33),t.k0s()),2&a&&(t.R7$(1),t.Y8G("ngIf",r.alert.message),t.R7$(20),t.Y8G("value",r.q),t.R7$(4),t.Y8G("value",r.statusFilter),t.R7$(9),t.Lme(" ",r.categoria.length," ",1===r.categoria.length?"categoria":"categorias"," "),t.R7$(15),t.Y8G("ngForOf",r.categoria),t.R7$(1),t.Y8G("ngIf",!r.loading&&0===r.categoria.length),t.R7$(1),t.Y8G("ngIf",r.loading),t.R7$(1),t.Y8G("ngIf",r.errorMsg),t.R7$(1),t.Y8G("ngIf",r.showModalForm))},dependencies:[d.YU,d.Sq,d.bT,i.xH,i.y7,h],styles:[".text-sucess[_ngcontent-%COMP%]{color:green}"]})}}return o})()}];let E=(()=>{class o{static{this.\u0275fac=function(a){return new(a||o)}}static{this.\u0275mod=t.$C({type:o})}static{this.\u0275inj=t.G2t({imports:[g.iI.forChild(k),g.iI]})}}return o})(),j=(()=>{class o{static{this.\u0275fac=function(a){return new(a||o)}}static{this.\u0275mod=t.$C({type:o})}static{this.\u0275inj=t.G2t({imports:[d.MD,i.X1,E]})}}return o})()}}]);